"use strict";(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[2298],{62298:(ee,U,u)=>{u.r(U),u.d(U,{Np0401Module:()=>Ma});var g=u(69808),k=u(78555),L=u(31890),_=u(93075),R=u(86347),x=u(99291),b=u(15861),e=u(87587),O=u(14525),d=u(57553),T=u(59783),q=u(71764),te=u(63900),ie=u(68306),D=u(75809),w=u(45682),F=u(22734),y=u(45330),C=u(40845),A=u(23099),N=u(51062);function ae(i,n){1&i&&e._UZ(0,"col"),2&i&&e.Udp("width",n.$implicit.width)}function ne(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e._UZ(1,"col",15),e.YNc(2,ae,1,2,"col",16),e.qZA()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("ngForOf",t)}}function oe(i,n){1&i&&(e.TgZ(0,"th",19),e._UZ(1,"p-tableHeaderCheckbox"),e.qZA())}function le(i,n){1&i&&e._UZ(0,"th",19)}function se(i,n){if(1&i&&(e.TgZ(0,"th",20),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",t.header," ")}}function pe(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,oe,2,0,"th",17),e.YNc(2,le,1,0,"th",17),e.YNc(3,se,2,3,"th",18),e.qZA()),2&i){const t=n.$implicit,a=e.oxw(2);e.xp6(1),e.Q6J("ngIf","multiple"==a.config.data.data.selectionMode),e.xp6(1),e.Q6J("ngIf","single"==a.config.data.data.selectionMode),e.xp6(1),e.Q6J("ngForOf",t)}}function ce(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"p-tableCheckbox",23),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t)}}function re(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"p-tableRadioButton",23),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t)}}function _e(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.lnq(" (",t.apiKey,",",t.moduleName,") - ",t.apiName," ")}}function de(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.hij(" ",a[t.field]," ")}}function ue(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"\uff0c"),e.qZA())}function me(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,ue,2,0,"span",22),e.qZA()),2&i){const t=n.$implicit,a=n.index,o=e.oxw(2).$implicit,l=e.oxw().$implicit,p=e.oxw(2);e.xp6(1),e.hij(" ",t.value," "),e.xp6(1),e.Q6J("ngIf",p.checkLength(l[o.field],a))}}function fe(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,me,3,2,"span",24),e.ALo(2,"keyvalue"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a[t.field]))}}function he(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span")(1,"a",25),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(2).downloadFile(o.filePath,o.fileName)}),e._uU(2),e.qZA()()}if(2&i){const t=e.oxw(2).$implicit,a=e.oxw(2);e.xp6(2),e.hij(" ",a.fileNameConvert(t.fileName)," ")}}function ge(i,n){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,_e,2,3,"span",22),e.YNc(2,de,2,1,"span",22),e.YNc(3,fe,3,3,"div",22),e.YNc(4,he,3,1,"span",22),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.Q6J("ngIf","apiName"==t.field),e.xp6(1),e.Q6J("ngIf","apiName"!=t.field&&"themeDatas"!=t.field&&"fileName"!=t.field),e.xp6(1),e.Q6J("ngIf","themeDatas"==t.field),e.xp6(1),e.Q6J("ngIf","fileName"==t.field)}}function be(i,n){if(1&i&&(e.TgZ(0,"tr",21),e.YNc(1,ce,2,1,"td",22),e.YNc(2,re,2,1,"td",22),e.YNc(3,ge,5,6,"td",16),e.qZA()),2&i){const t=n.$implicit,a=n.columns,o=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(1),e.Q6J("ngIf","multiple"==o.config.data.data.selectionMode),e.xp6(1),e.Q6J("ngIf","single"==o.config.data.data.selectionMode),e.xp6(1),e.Q6J("ngForOf",a)}}function ve(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",26)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",27),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).moreData()}),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"i",28),e.qZA()()()}if(2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(2),e.AsE("",e.lcZ(4,4,"row_count"),": ",a.rowcount,""),e.xp6(3),e.hij("",e.lcZ(7,6,"button.more")," ")}}function Ae(i,n){if(1&i&&e.YNc(0,ve,9,8,"tr",22),2&i){const t=e.oxw(2);e.Q6J("ngIf",t.rowcount)}}function Te(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"no_rec")," ")}}const qe=function(){return{"word-break":"break-word"}};function Ze(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"p-table",9),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().selected=o}),e.YNc(1,ne,3,1,"ng-template",10),e.YNc(2,pe,4,3,"ng-template",11),e.YNc(3,be,4,4,"ng-template",12),e.YNc(4,Ae,1,1,"ng-template",13),e.YNc(5,Te,4,4,"ng-template",14),e.qZA()}if(2&i){const t=e.oxw();e.Akn(e.DdM(5,qe)),e.Q6J("columns",t.cols)("value",t.dataList)("selection",t.selected)}}let Y=(()=>{class i{constructor(t,a,o,l,p){this.lov=t,this.tool=a,this.file=o,this.ref=l,this.config=p,this.keyword="",this.cols=[],this.dataList=new Array,this.rowcount=0}ngOnInit(){var t=this;return(0,b.Z)(function*(){const o=yield t.tool.getDict(["api_name","theme_name","org_name","api_desc","public_flag","api_doc"]);if(t.cols=[{field:"apiName",header:o.api_name},{field:"apiDesc",header:o.api_desc},{field:"publicFlagName",header:o.public_flag},{field:"orgName",header:o.org_name},{field:"themeDatas",header:o.theme_name},{field:"fileName",header:o.api_doc}],t.dataList=t.config.data.data.apiList,t.rowcount=t.dataList.length,t.keyword=t.config.data.data.keyword,"#/np04/np0401"==window.location.hash)switch(t.config.data.data.dpStatus){case"0":t.selected={},t.config.data.data.selectedApis&&(t.selected=t.dataList.filter(l=>l.apiUid==t.config.data.data.selectedApis.apiUid)[0]);break;case"1":t.selected=new Array,t.config.data.data.selectedApis&&t.config.data.data.selectedApis.map(l=>{t.selected=t.selected.concat(t.dataList.filter(p=>p.apiUid==l.apiUid))})}else t.selected=t.config.data.data.selectedApis})()}searchAPI(){if(this.dataList=[],this.rowcount=this.dataList.length,"#/np04/np0401"==window.location.hash)switch(this.data.data.dpStatus){case"0":this.selected={};break;case"1":this.selected=new Array}else this.selected=new Array;this.lov.queryApiLov({keyword:this.keyword,dpStatus:this.config.data.data.dpStatus}).subscribe(a=>{this.tool.checkDpSuccess(a.ResHeader)&&(this.dataList=a.RespBody.dataList,this.rowcount=this.dataList.length)})}chooseAPI(){this.ref.close(this.selected)}moreData(){this.lov.queryApiLov({apiKey:this.dataList[this.dataList.length-1].apiKey,moduleName:this.dataList[this.dataList.length-1].moduleName,keyword:this.keyword,dpStatus:this.config.data.data.dpStatus}).subscribe(a=>{this.tool.checkDpSuccess(a.ResHeader)&&(this.dataList=this.dataList.concat(a.RespBody.dataList),this.rowcount=this.dataList.length)})}checkLength(t,a){return Object.keys(t).length>1&&a+1!=Object.keys(t).length}downloadFile(t,a){this.file.downloadFile({filePath:t}).subscribe(l=>{const p=new FileReader;p.onloadend=function(){const s=new File([l],a),r=window.URL.createObjectURL(s),c=document.createElement("a");document.body.appendChild(c),c.setAttribute("style","display: none"),c.href=r,c.download=a,c.click(),window.URL.revokeObjectURL(r),c.remove()},p.readAsText(l)})}fileNameConvert(t){return t?decodeURIComponent(t):""}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.A),e.Y36(w.g),e.Y36(F.I),e.Y36(y.E7),e.Y36(y.S))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-api-lov"]],inputs:{data:"data",close:"close"},decls:14,vars:8,consts:[[1,"container","py-1"],[1,"row"],[1,"col-12","col-sm-12"],[1,"ui-inputgroup"],["type","text",1,"form-control",3,"placeholder","ngModel","ngModelChange","keyup.enter"],["pButton","","type","button","icon","pi pi-search",1,"tpi-night",3,"click"],["styleClass","p-datatable-striped",3,"columns","value","selection","style","selectionChange",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","tpi-btn","tpi-primary",3,"click"],["styleClass","p-datatable-striped",3,"columns","value","selection","selectionChange"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[2,"width","2.25em"],[3,"width",4,"ngFor","ngForOf"],["style","width: 2.25em","scope","col",4,"ngIf"],["scope","col",3,"width",4,"ngFor","ngForOf"],["scope","col",2,"width","2.25em"],["scope","col"],[3,"pSelectableRow"],[4,"ngIf"],[3,"value"],[4,"ngFor","ngForOf"],["href","javascript:void(0)",3,"click"],[2,"color","#b7b7b7"],["type","button",1,"btn","tpi-header-return",3,"click"],[1,"fas","fa-angle-double-right",2,"margin-left","5px"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"input",4),e.NdJ("ngModelChange",function(l){return a.keyword=l})("keyup.enter",function(){return a.searchAPI()}),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return a.searchAPI()}),e.qZA()()()(),e._UZ(7,"br"),e.YNc(8,Ze,6,6,"p-table",6),e._UZ(9,"br"),e.TgZ(10,"div",7)(11,"button",8),e.NdJ("click",function(){return a.chooseAPI()}),e._uU(12),e.ALo(13,"translate"),e.qZA()()()),2&t&&(e.xp6(4),e.s9C("placeholder",e.lcZ(5,4,"keyword_search")),e.Q6J("ngModel",a.keyword),e.xp6(4),e.Q6J("ngIf",a.cols),e.xp6(4),e.Oqu(e.lcZ(13,6,"button.save")))},directives:[_.Fj,_.JJ,_.On,C.Hq,g.O5,A.iA,T.jx,g.sg,A.Mo,A.Ei,A.UA,A.GE],pipes:[N.X$,g.Nd],styles:[""]}),i})();var Z=u(1694);function xe(i,n){1&i&&e._UZ(0,"col"),2&i&&e.Udp("width",n.$implicit.width)}function ye(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e._UZ(1,"col",15),e.YNc(2,xe,1,2,"col",16),e.qZA()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("ngForOf",t)}}function Ne(i,n){if(1&i&&(e.TgZ(0,"th",19),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",t.header," ")}}function we(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"th",17),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.YNc(3,Ne,2,3,"th",18),e.qZA()),2&i){const t=n.$implicit;e.xp6(3),e.Q6J("ngForOf",t)}}function Oe(i,n){if(1&i&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&i){const t=n.$implicit,a=e.oxw().$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",a[t.field]," ")}}function Ce(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",20),e.qZA(),e.YNc(3,Oe,2,3,"td",16),e.qZA()),2&i){const t=n.$implicit,a=n.columns;e.xp6(2),e.Q6J("value",t),e.xp6(1),e.Q6J("ngForOf",a)}}function De(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",22)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).moreData()}),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"i",24),e.qZA()()()}if(2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(2),e.AsE("",e.lcZ(4,4,"row_count"),": ",a.rowcount,""),e.xp6(3),e.hij("",e.lcZ(7,6,"button.more")," ")}}function Fe(i,n){if(1&i&&e.YNc(0,De,9,8,"tr",21),2&i){const t=e.oxw(2);e.Q6J("ngIf",t.rowcount)}}function Ie(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"no_rec")," ")}}const Ue=function(){return{"word-break":"break-word"}};function ke(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"p-table",9),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().selected=o}),e.YNc(1,ye,3,1,"ng-template",10),e.YNc(2,we,4,1,"ng-template",11),e.YNc(3,Ce,4,2,"ng-template",12),e.YNc(4,Fe,1,1,"ng-template",13),e.YNc(5,Ie,4,4,"ng-template",14),e.qZA()}if(2&i){const t=e.oxw();e.Akn(e.DdM(5,Ue)),e.Q6J("columns",t.cols)("value",t.dataList)("selection",t.selected)}}let Le=(()=>{class i{constructor(t,a,o,l){this.tool=t,this.lov=a,this.ref=o,this.config=l,this.cols=[],this.keyword="",this.dataList=new Array,this.selected=new Array,this.rowcount=0}ngOnInit(){var t=this;return(0,b.Z)(function*(){console.log(t.config);const o=yield t.tool.getDict(["theme_name"]);switch(t.cols=[{field:"themeName",header:o.theme_name}],t.dataList=t.config.data.data.dataList,t.rowcount=t.dataList.length,t.keyword=t.config.data.data.keyword,t.config.data&&t.config.data.operate){case d.mi.create:t.selected=t.config.data.data.selectedThemes;break;case d.mi.update:t.config.data.data.selectedThemes.map(l=>{t.selected=t.selected.concat(t.dataList.filter(p=>p.themeId==l.themeId))})}})()}searchThemes(){this.dataList=[],this.lov.queryThemeLov({keyword:this.keyword}).subscribe(a=>{this.tool.checkDpSuccess(a.ResHeader)&&(this.dataList=a.RespBody.dataList,this.rowcount=this.dataList.length)})}moreData(){this.lov.queryThemeLov({themeId:this.dataList[this.dataList.length-1].themeId,keyword:this.keyword}).subscribe(a=>{this.tool.checkDpSuccess(a.ResHeader)&&(this.dataList=this.dataList.concat(a.RespBody.dataList),this.rowcount=this.dataList.length)})}chooseThemes(){this.ref.close(this.selected)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.g),e.Y36(D.A),e.Y36(y.E7),e.Y36(y.S))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-theme-lov"]],inputs:{data:"data",close:"close"},decls:14,vars:8,consts:[[1,"container","py-1"],[1,"row"],[1,"col-12","col-sm-12"],[1,"ui-inputgroup"],["type","text",1,"form-control",3,"placeholder","ngModel","ngModelChange","keyup.enter"],["pButton","","type","button","icon","pi pi-search",1,"tpi-night","ms-1",3,"click"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","selection","style","selectionChange",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","tpi-btn","tpi-primary",3,"click"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","selection","selectionChange"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[2,"width","2.25em"],[3,"width",4,"ngFor","ngForOf"],["scope","col",2,"width","2.25em"],["scope","col",3,"width",4,"ngFor","ngForOf"],["scope","col"],[3,"value"],[4,"ngIf"],[2,"color","#b7b7b7"],["type","button",1,"btn","tpi-header-return",3,"click"],[1,"fas","fa-angle-double-right",2,"margin-left","5px"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"input",4),e.NdJ("ngModelChange",function(l){return a.keyword=l})("keyup.enter",function(){return a.searchThemes()}),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return a.searchThemes()}),e.qZA()()()(),e._UZ(7,"br"),e.YNc(8,ke,6,6,"p-table",6),e._UZ(9,"br"),e.TgZ(10,"div",7)(11,"button",8),e.NdJ("click",function(){return a.chooseThemes()}),e._uU(12),e.ALo(13,"translate"),e.qZA()()()),2&t&&(e.xp6(4),e.s9C("placeholder",e.lcZ(5,4,"keyword_search")),e.Q6J("ngModel",a.keyword),e.xp6(4),e.Q6J("ngIf",a.cols),e.xp6(4),e.Oqu(e.lcZ(13,6,"button.save")))},directives:[_.Fj,_.JJ,_.On,C.Hq,g.O5,A.iA,T.jx,g.sg,A.Mo,A.UA],pipes:[N.X$],styles:[""]}),i})();var Re=u(86518),J=u(86561),Q=u(17773);const Ye=["dialog"];function Je(i,n){if(1&i&&(e.TgZ(0,"div",17)(1,"small",18),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,t.apiName.errors.required))}}function Qe(i,n){if(1&i&&(e.TgZ(0,"div",17)(1,"small",18),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,t.themeName.errors.required))}}const Pe=function(){return{marginTop:"60px"}};let Se=(()=>{class i{constructor(t,a,o,l,p,s,r){this.fb=t,this.lov=a,this.tool=o,this.alert=l,this.file=p,this.message=s,this.dialogService=r,this.change=new e.vpe,this.remove=new e.vpe,this.isInvalid=new e.vpe,this.dialogTitle="",this.selectedThemes=new Array}ngOnInit(){this.form=this.fb.group({apiUid:new _.NI(this.data?this.data.apiUid:""),apiName:new _.NI(this.data?this.data.apiName:"",Z.np()),themeId:new _.NI(this.data?this.data.refThemeId:[]),themeName:new _.NI(this.data?this.data.refThemeName:[],Z.np()),fileName:new _.NI({value:this.data?this.data.fileName:null,disabled:!0}),tempFileName:new _.NI({value:this.data?this.data.tempFileName:null,disabled:!0})}),this.form.valueChanges.subscribe(t=>{this.isInvalid.emit(this.form.invalid),this.change.emit({no:this.no,apiUid:this.apiUid.value,refThemeId:this.themeId.value,fileName:this.fileName.value,tempFileName:this.tempFileName.value})})}searchAPI(){var t=this;let a={dpStatus:"0"};if(this.data&&"#/np04/np0401"==window.location.hash){a.keyword=this.data.apiName;let o={};for(let l=0;l<this.data.refThemeId.length;l++)o[this.data.refThemeId[l]]=this.data.refThemeName[l];this.selectedApis={apiUid:this.data.apiUid,apiName:this.data.apiName,fileName:this.data.fileName,themeDatas:o}}this.lov.queryApiLov(a).subscribe(function(){var o=(0,b.Z)(function*(l){if(t.tool.checkDpSuccess(l.ResHeader)){const p=["un_shelves_api_search"],s=yield t.tool.getDict(p);t.dialogTitle=s.un_shelves_api_search,t.dialogService.open(Y,{data:{displayInDialog:!0,data:{dpStatus:"0",selectedApis:t.selectedApis,apiList:l.RespBody.dataList,selectionMode:"single",keyword:a.keyword}},width:"80vw",height:"100vh",header:s.un_shelves_api_search}).onClose.subscribe(c=>{var m,f;c&&(t.data&&"#/np04/np0401"==window.location.hash&&(t.data.apiUid=c.apiUid,t.data.apiName=c.apiName),t.selectedApis=c,t.apiUid.setValue(null===(m=t.selectedApis)||void 0===m?void 0:m.apiUid),t.apiName.setValue(null===(f=t.selectedApis)||void 0===f?void 0:f.apiName))})}});return function(l){return o.apply(this,arguments)}}())}searchTheme(){var t=this;let a={};if(this.data&&"#/np04/np0401"==window.location.hash){this.selectedThemes=[];for(let l=0;l<this.data.refThemeId.length;l++)this.selectedThemes.push({themeId:this.data.refThemeId[l],themeName:this.data.refThemeName[l]});let o="";for(let l of this.data.refThemeName)o+=`${l} `;a.keyword=o}this.lov.queryThemeLov(a).subscribe(function(){var o=(0,b.Z)(function*(l){if(t.tool.checkDpSuccess(l.ResHeader)){const p=["theme_list"],s=yield t.tool.getDict(p);t.dialogTitle=s.theme_list,t.dialogService.open(Le,{data:{operate:t.data?d.mi.update:d.mi.create,displayInDialog:!0,data:{selectedThemes:t.selectedThemes,dataList:l.RespBody.dataList,keyword:a.keyword}},width:"50vw",height:"100vh",header:s.theme_list}).onClose.subscribe(c=>{if(c){t.selectedThemes=c;let m=[],f=[];for(let h of t.selectedThemes)m.push(h.themeId),f.push(h.themeName);t.data&&"#/np04/np0401"==window.location.hash&&(t.data.refThemeId=m,t.data.refThemeName=f),t.themeId.setValue(m),t.themeName.setValue(f)}})}});return function(l){return o.apply(this,arguments)}}())}openFileBrowser(){$("#choose-file_"+this.no).click()}delete(){this._ref.destroy(),this.remove.emit(this.no)}get apiUid(){return this.form.get("apiUid")}get apiName(){return this.form.get("apiName")}get themeId(){return this.form.get("themeId")}get themeName(){return this.form.get("themeName")}get fileName(){return this.form.get("fileName")}get tempFileName(){return this.form.get("tempFileName")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.qu),e.Y36(D.A),e.Y36(w.g),e.Y36(Re.c),e.Y36(F.I),e.Y36(T.ez),e.Y36(y.xA))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-api-shelves"]],viewQuery:function(t,a){if(1&t&&e.Gf(Ye,5),2&t){let o;e.iGM(o=e.CRH())&&(a._dialog=o.first)}},inputs:{_ref:"_ref",no:"no",data:"data",subType:"subType"},outputs:{change:"change",remove:"remove",isInvalid:"isInvalid"},features:[e._Bn([T.ez,y.E7])],decls:26,vars:23,consts:[[1,"row","mb-1",3,"formGroup"],[1,"col-3","col-lg-3","col-sm-3"],[1,"ui-inputgroup"],["type","text","formControlName","apiName",1,"form-control",3,"placeholder"],["pButton","","type","button","icon","pi pi-search",1,"tpi-night","ms-1",3,"disabled","click"],["class","text-danger",4,"ngIf"],["type","text","formControlName","themeName",1,"form-control",3,"placeholder"],["pButton","","type","button","icon","pi pi-search",1,"tpi-night","ms-1",3,"click"],[1,"col-4","col-lg-4","col-sm-4"],["type","file",2,"display","none",3,"id"],["type","text","formControlName","fileName",1,"form-control",3,"placeholder"],["pButton","","type","button","icon","pi pi-upload",1,"tpi-night","ms-1",3,"click"],[1,"col-2","col-lg-2","col-sm-2"],["type","button",1,"btn","tpi-btn","tpi-primary","pull-right",3,"click"],[3,"title"],["dialog",""],["position","top-left"],[1,"text-danger"],[1,"form-text"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"input",3),e.ALo(4,"translate"),e.TgZ(5,"button",4),e.NdJ("click",function(){return a.searchAPI()}),e.qZA()(),e.YNc(6,Je,4,3,"div",5),e.qZA(),e.TgZ(7,"div",1)(8,"div",2),e._UZ(9,"input",6),e.ALo(10,"translate"),e.TgZ(11,"button",7),e.NdJ("click",function(){return a.searchTheme()}),e.qZA()(),e.YNc(12,Qe,4,3,"div",5),e.qZA(),e.TgZ(13,"div",8)(14,"div",2),e._UZ(15,"input",9)(16,"input",10),e.ALo(17,"translate"),e.TgZ(18,"button",11),e.NdJ("click",function(){return a.openFileBrowser()}),e.qZA()()(),e.TgZ(19,"div",12)(20,"button",13),e.NdJ("click",function(){return a.delete()}),e._uU(21),e.ALo(22,"translate"),e.qZA()()(),e._UZ(23,"app-dialog",14,15)(25,"p-toast",16)),2&t&&(e.Q6J("formGroup",a.form),e.xp6(3),e.s9C("placeholder",e.lcZ(4,14,"api_list")),e.uIk("disabled",!0),e.xp6(2),e.Q6J("disabled","API_ON_UPDATE"==a.subType),e.xp6(1),e.Q6J("ngIf",(null==a.apiName?null:a.apiName.invalid)&&((null==a.apiName?null:a.apiName.dirty)||(null==a.apiName?null:a.apiName.touched))),e.xp6(3),e.s9C("placeholder",e.lcZ(10,16,"theme_name")),e.uIk("disabled",!0),e.xp6(3),e.Q6J("ngIf",(null==a.themeName?null:a.themeName.invalid)&&((null==a.themeName?null:a.themeName.dirty)||(null==a.themeName?null:a.themeName.touched))),e.xp6(3),e.MGl("id","choose-file_",a.no,""),e.xp6(1),e.s9C("placeholder",e.lcZ(17,18,"api_doc_upload")),e.xp6(5),e.Oqu(e.lcZ(22,20,"button.delete")),e.xp6(2),e.Q6J("title",a.dialogTitle),e.xp6(2),e.Akn(e.DdM(22,Pe)))},directives:[_.JL,_.sg,_.Fj,_.JJ,_.u,C.Hq,g.O5,J.a,Q.FN],pipes:[N.X$],styles:[""]}),i})();var B=u(46877),M=u(50077),S=u(3937),P=u(37410),E=u(75652);const Ee=["dialog"],Be=["apiShelves"],$e=["content"];function Me(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.createDateTime)}}function je(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.data.data.createDateTime)}}function He(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.userAlias)}}function ze(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.data.data.applyUserName)}}function Ve(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.orgName)}}function Ge(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.data.data.orgName)}}function Ke(i,n){if(1&i&&(e.TgZ(0,"div",18)(1,"label",19),e._UZ(2,"input",20),e._uU(3),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.s9C("value",t.value),e.xp6(1),e.hij("",t.label," ")}}function Xe(i,n){if(1&i&&(e.TgZ(0,"div",21)(1,"small",22),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,t.reqSubtype.errors.required))}}function We(i,n){if(1&i&&(e.TgZ(0,"div",18)(1,"label",19),e._UZ(2,"input",23),e._uU(3),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.s9C("value",t.value),e.xp6(1),e.hij("",t.label," ")}}function et(i,n){if(1&i&&(e.TgZ(0,"div",21)(1,"small",22),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,t.encPublicFlag.errors.required))}}function tt(i,n){if(1&i&&(e.TgZ(0,"div",21)(1,"small",22),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,t.effectiveDate.errors.required))}}function it(i,n){if(1&i&&(e.TgZ(0,"div",21)(1,"small",22),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,1,t.reqDesc.errors.required))}}function at(i,n){}function nt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",2)(2,"div",24)(3,"div",25)(4,"div",26)(5,"label",6),e._uU(6),e.ALo(7,"translate"),e.qZA()(),e.TgZ(8,"div",26)(9,"label",6),e._uU(10),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"div",27)(13,"label",4),e._uU(14),e.ALo(15,"translate"),e.TgZ(16,"small",28),e._uU(17),e.ALo(18,"translate"),e.ALo(19,"translate"),e.qZA()()()(),e.TgZ(20,"div",29),e.YNc(21,at,0,0,"ng-template",null,30,e.W1O),e.qZA(),e.TgZ(23,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw().addApiOnOffRef()}),e._uU(24),e.ALo(25,"translate"),e.qZA()()()()}2&i&&(e.xp6(6),e.Oqu(e.lcZ(7,6,"choose_api")),e.xp6(4),e.Oqu(e.lcZ(11,8,"chs_themes")),e.xp6(4),e.hij(" ",e.lcZ(15,10,"api_doc_upload")," "),e.xp6(3),e.AsE(" ",e.lcZ(18,12,"cfm_size"),"\uff0c",e.lcZ(19,14,"cfm_unrestricted_format"),""),e.xp6(7),e.Oqu(e.lcZ(25,16,"button.new")))}function ot(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",45)(1,"button",46),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).delete()}),e._uU(2),e.ALo(3,"translate"),e.qZA()()}2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"button.delete")," "))}function lt(i,n){1&i&&e._UZ(0,"col"),2&i&&e.Udp("width",n.$implicit.width)}function st(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e._UZ(1,"col",47),e.YNc(2,lt,1,2,"col",48),e.qZA()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("ngForOf",t)}}function pt(i,n){if(1&i&&(e.TgZ(0,"th",51),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",t.header," ")}}function ct(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"th",49),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.YNc(3,pt,2,3,"th",50),e.qZA()),2&i){const t=n.$implicit;e.xp6(3),e.Q6J("ngForOf",t)}}function rt(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.lnq(" (",t.apiKey,",",t.moduleName,") - ",t.apiName," ")}}function _t(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.Oqu(a[t.field])}}function dt(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"\uff0c"),e.qZA())}function ut(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,dt,2,0,"span",5),e.qZA()),2&i){const t=n.$implicit,a=n.index,o=e.oxw(2).$implicit,l=e.oxw().$implicit,p=e.oxw(3);e.xp6(1),e.hij(" ",t.value," "),e.xp6(1),e.Q6J("ngIf",p.checkLength(l[o.field],a))}}function mt(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ut,3,2,"span",53),e.ALo(2,"keyvalue"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a[t.field]))}}function ft(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span")(1,"a",54),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).downloadFile(o.filePath,o.fileName)}),e._uU(2),e.qZA()()}if(2&i){const t=e.oxw(2).$implicit,a=e.oxw(3);e.xp6(2),e.hij(" ",a.fileNameConvert(t.fileName)," ")}}function ht(i,n){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,rt,2,3,"span",5),e.YNc(2,_t,2,1,"span",5),e.YNc(3,mt,3,3,"div",5),e.YNc(4,ft,3,1,"span",5),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.Q6J("ngIf","apiName"==t.field),e.xp6(1),e.Q6J("ngIf","apiName"!=t.field&&"themeDatas"!=t.field&&"fileName"!=t.field),e.xp6(1),e.Q6J("ngIf","themeDatas"==t.field),e.xp6(1),e.Q6J("ngIf","fileName"==t.field)}}function gt(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",52),e.qZA(),e.YNc(3,ht,5,6,"td",48),e.qZA()),2&i){const t=n.$implicit,a=n.columns;e.xp6(2),e.Q6J("value",t),e.xp6(1),e.Q6J("ngForOf",a)}}function bt(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw().$implicit,a=e.oxw(3);e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.AsE("",e.lcZ(3,3,"row_count"),": ",a.rowcount,"")}}function vt(i,n){if(1&i&&e.YNc(0,bt,4,5,"tr",5),2&i){const t=e.oxw(3);e.Q6J("ngIf",t.rowcount)}}function At(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"no_rec")," ")}}const Tt=function(){return{"word-break":"break-word"}};function qt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"p-table",38),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw(2).apiOffSelected=o}),e.YNc(1,ot,4,3,"ng-template",39),e.YNc(2,st,3,1,"ng-template",40),e.YNc(3,ct,4,1,"ng-template",41),e.YNc(4,gt,4,2,"ng-template",42),e.YNc(5,vt,1,1,"ng-template",43),e.YNc(6,At,4,4,"ng-template",44),e.qZA()}if(2&i){const t=e.oxw(2);e.Akn(e.DdM(5,Tt)),e.Q6J("columns",t.cols)("value",t.apiOffDataList)("selection",t.apiOffSelected)}}function Zt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",32)(1,"div",2)(2,"div",33)(3,"div",34)(4,"input",35),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().keyword=o}),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"button",36),e.NdJ("click",function(){return e.CHM(t),e.oxw().searchShelvesAPI("API_OFF")}),e.qZA()()()(),e.YNc(7,qt,7,6,"p-table",37),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",e.lcZ(5,3,"keyword_search")),e.Q6J("ngModel",t.keyword),e.xp6(3),e.Q6J("ngIf",t.cols)}}function xt(i,n){}function yt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",2)(2,"div",33)(3,"div",34)(4,"input",35),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().keyword=o}),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"button",36),e.NdJ("click",function(){return e.CHM(t),e.oxw().searchShelvesAPI("API_ON_UPDATE")}),e.qZA()()()(),e.TgZ(7,"div",2)(8,"div",24)(9,"div",25)(10,"div",26)(11,"label"),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"div",26)(15,"label"),e._uU(16),e.ALo(17,"translate"),e.qZA()(),e.TgZ(18,"div",27)(19,"label"),e._uU(20),e.ALo(21,"translate"),e.TgZ(22,"small",28),e._uU(23),e.ALo(24,"translate"),e.ALo(25,"translate"),e.qZA()()()(),e.TgZ(26,"div",29),e.YNc(27,xt,0,0,"ng-template",null,30,e.W1O),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",e.lcZ(5,7,"keyword_search")),e.Q6J("ngModel",t.keyword),e.xp6(8),e.Oqu(e.lcZ(13,9,"choose_api")),e.xp6(4),e.Oqu(e.lcZ(17,11,"chs_themes")),e.xp6(4),e.hij(" ",e.lcZ(21,13,"api_doc_upload")," "),e.xp6(3),e.AsE(" ",e.lcZ(24,15,"cfm_size"),"",e.lcZ(25,17,"cfm_unrestricted_format"),"")}}const Nt=function(){return{marginTop:"60px"}};let wt=(()=>{class i{constructor(t,a,o,l,p,s,r,c,m,f,h,v){this.fb=t,this.tool=a,this.factoryResolver=o,this.lov=l,this.router=p,this.message=s,this.list=r,this.orgService=c,this.file=m,this.ngxService=f,this.requisition=h,this.dialogService=v,this.onChange=I=>{},this.apiOnOffs=new Array,this.value=new Array,this.disabled=!1,this.apiOnOffNo=0,this.cols=[],this.apiOffDataList=new Array,this.apiOffSelected=new Array,this.apiOnUpdateSelected=new Array,this.dialogTitle="",this.rowcount=0,this.userAlias="",this.orgName="",this.keyword="",this.createDateTime="",this.formOperate=d.mi,this.subTypes=[],this.publicFlags=[],this.isInvalid=!0,this.btnName="",this.minDateValue=new Date,this.oriApi=new Array,this.form=this.fb.group({reqSubtype:new _.NI(""),reqDesc:new _.NI(""),effectiveDate:new _.NI(""),encPublicFlag:new _.NI("")})}ngOnInit(){var t=this;return(0,b.Z)(function*(){t.form=t.fb.group(t.resetFormGroup(t.data.operate));let a={encodeItemNo:t.tool.Base64Encoder(t.tool.BcryptEncoder("API_ON_OFF"))+",5",isDefault:"N"};t.list.querySubItemsByItemNo(a).subscribe(s=>{var r;if(t.tool.checkDpSuccess(s.ResHeader)){let c=[];null===(r=s.RespBody.subItems)||void 0===r||r.map(m=>{c.push({label:m.subitemName,value:m.subitemNo})}),t.subTypes=c}});let o={encodeItemNo:t.tool.Base64Encoder(t.tool.BcryptEncoder("API_AUTHORITY"))+",7",isDefault:"N"};t.list.querySubItemsByItemNo(o).subscribe(s=>{var r;if(t.tool.checkDpSuccess(s.ResHeader)){let c=[];null===(r=s.RespBody.subItems)||void 0===r||r.map(m=>{"-1"!=m.subitemNo&&c.push({label:m.subitemName,value:m.subitemNo})}),t.publicFlags=c}}),t.reqSubtype.valueChanges.subscribe(s=>{t.apiOnOffs=[],t.apiOffDataList=[],t.apiOffSelected=[],t.apiOnUpdateSelected=[]});const p=yield t.tool.getDict(["api_name","api_desc","public_flag","org_name","theme_name","api_doc","button.save","button.update","button.resend"]);switch(t.cols=[{field:"apiName",header:p.api_name},{field:"apiDesc",header:p.api_desc},{field:"publicFlagName",header:p.public_flag},{field:"orgName",header:p.org_name},{field:"themeDatas",header:p.theme_name},{field:"fileName",header:p.api_doc}],t.data.operate){case d.mi.create:t.btnName=p["button.save"],t.createDateTime=q(new Date).format("YYYY/MM/DD"),t.userAlias=t.tool.getUserAlias(),t.orgService.queryTOrgList({orgID:t.tool.getOrgId()}).subscribe(s=>{t.tool.checkDpSuccess(s.ResHeader)&&(t.orgName=s.RespBody.orgList[0].orgName)});break;case d.mi.update:case d.mi.resend:t.btnName=t.data.operate==d.mi.update?p["button.update"]:p["button.resend"],"API_ON"==t.reqSubtype.value||"API_ON_UPDATE"==t.reqSubtype.value?t.data.data.apiOnOff.apiOnOffList.map(s=>{let r=[],c=[];Object.keys(s.themeList).map(m=>{r.push(parseInt(m)),c.push(s.themeList[m])}),window.setTimeout(()=>{t.addApiOnOffRef({apiUid:s.apiUid,apiName:s.apiName,refThemeId:r,refThemeName:c,fileName:Object.keys(s.docFileInfo)[0],tempFileName:null}),t.isInvalid=!1})}):(t.oriApi=t.data.data.apiOnOff.apiOnOffList,t.data.data.apiOnOff.apiOnOffList.map(s=>{let r=Object.keys(s.docFileInfo)[0];t.apiOffDataList.push({apiUid:s.apiUid,apiKey:s.apiKey,apiName:s.apiName,apiDesc:s.apiDesc,orgName:s.orgName,themeDatas:s.themeList,fileName:r,filePath:s.docFileInfo[r],moduleName:s.moduleName})}))}})()}addApiOnOffRef(t){this.data.operate!=d.mi.create&&"#/np04/np0401"==window.location.hash&&(this.apiOnUpdateSelected=this.data.data.apiOnOff.apiOnOffList),console.log(t);let a=this.apiShelvesRef.createComponent(Se);this.isInvalid=this.data.operate==d.mi.create,this.apiOnOffs.push(t?{no:this.apiOnOffNo,apiUid:t.apiUid,apiName:t.apiName,refThemeId:t.refThemeId,refThemeName:t.refThemeName,fileName:t.fileName,tempFileName:t.tempFileName}:{no:this.apiOnOffNo,apiUid:"",apiName:"",refThemeId:[],refThemeName:[],fileName:null,tempFileName:null}),a.instance._ref=a,a.instance.no=this.apiOnOffNo,a.instance.data=t,a.instance.subType=this.reqSubtype.value,this.apiOnOffNo++,a.instance.change.subscribe(o=>{if(this.apiOnOffs.findIndex(s=>s.no===o.no)||0!=this.apiOnOffs.length){let s=this.apiOnOffs.findIndex(r=>r.no===o.no);this.apiOnOffs[s].no=o.no,this.apiOnOffs[s].apiUid=o.apiUid,this.apiOnOffs[s].apiName=o.apiName,this.apiOnOffs[s].refThemeId=o.refThemeId,this.apiOnOffs[s].refThemeName=o.refThemeName,this.apiOnOffs[s].fileName=o.fileName,this.apiOnOffs[s].tempFileName=o.tempFileName}else this.apiOnOffs.push({no:this.apiOnOffNo,apiUid:"",apiName:"",refThemeId:[],refThemeName:[],fileName:null,tempFileName:null});let p=this.apiOnOffs.map(s=>({apiUid:s.apiUid,apiName:s.apiName,refThemeId:s.refThemeId,refThemeName:s.refThemeName,fileName:s.fileName,tempFileName:s.tempFileName}));this.onChange(p)}),a.instance.remove.subscribe(o=>{let l=this.apiOnOffs.findIndex(s=>s.no===o),p=this.apiOnOffs.find(s=>s.no==o);if(this.apiOnOffs.splice(l,1),this.onChange(this.apiOnOffs),this.data.operate!=d.mi.create&&"#/np04/np0401"==window.location.hash){let s=this.apiOnUpdateSelected.findIndex(r=>r.apiUid==p.apiUid);this.apiOnUpdateSelected.splice(s,1)}}),a.instance.isInvalid.subscribe(o=>{this.isInvalid=o})}delete(){this.apiOffSelected.map(t=>{this.apiOffDataList=this.apiOffDataList.filter(a=>a.apiUid!=t.apiUid)}),this.apiOffSelected=[]}searchShelvesAPI(t){var a=this;return(0,b.Z)(function*(){a.lov.queryApiLov({keyword:a.keyword,dpStatus:"1"}).subscribe(function(){var l=(0,b.Z)(function*(p){if(a.tool.checkDpSuccess(p.ResHeader)){const s=["on_shelves_api_search"],r=yield a.tool.getDict(s);switch(a.dialogTitle=r.on_shelves_api_search,t){case"API_OFF":a.dialogService.open(Y,{data:{data:{dpStatus:"1",selectedApis:a.apiOffDataList,apiList:p.RespBody.dataList,selectionMode:"multiple",keyword:a.keyword},width:"80vw",height:"100vh"},header:r.on_shelves_api_search}).onClose.subscribe(f=>{f&&(a.keyword="",a.data.operate!=d.mi.create&&"#/np04/np0401"==window.location.hash&&(a.data.data.apiOnOff.apiOnOffList=f),a.apiOffDataList=f,a.rowcount=a.apiOffDataList.length)});break;case"API_ON_UPDATE":console.log("update"),a.dialogService.open(Y,{data:{data:{dpStatus:"1",selectedApis:a.apiOnUpdateSelected,apiList:p.RespBody.dataList,selectionMode:"multiple",keyword:a.keyword},width:"80vw",height:"100vh"},header:a.dialogTitle}).onClose.subscribe(f=>{if(f){a.keyword="",a.data.operate!=d.mi.create&&"#/np04/np0401"==window.location.hash&&(a.data.data.apiOnOff.apiOnOffList=f),a.apiOnUpdateSelected=f;let h=new Set;for(let v of f){let I=[],X=[];Object.keys(v.themeDatas).map(W=>{I.push(W),X.push(v.themeDatas[W])}),h.has(v.apiUid)||(console.log(v),a.addApiOnOffRef({apiUid:v.apiUid,apiName:v.apiName,refThemeId:I,refThemeName:X,fileName:v.fileName,tempFileName:null}))}a.isInvalid=!1}})}}});return function(p){return l.apply(this,arguments)}}())})()}submitForm(){var t=this;switch(this.data.operate){case d.mi.create:let a={reqType:"API_ON_OFF",reqSubtype:this.reqSubtype.value,effectiveDate:q(this.effectiveDate.value).format("YYYY/MM/DD"),reqDesc:this.reqDesc.value,apiOnOffD:this.converApiOnOffData(this.reqSubtype.value)};this.ngxService.start(),this.requisition.createReq(a).subscribe(function(){var p=(0,b.Z)(function*(s){if(t.tool.checkDpSuccess(s.ResHeader)){const r=["message.create","message.requisition.api_on_off","message.success"],c=yield t.tool.getDict(r);t.message.add({severity:"success",summary:`${c["message.create"]} ${c["message.requisition.api_on_off"]}`,detail:`${c["message.create"]} ${c["message.success"]}!`}),window.setTimeout(()=>{t.router.navigateByUrl("/RefreshComponent",{skipLocationChange:!0}).then(()=>{t.router.navigate(["np03","np0301"])})},1e3)}});return function(s){return p.apply(this,arguments)}}());break;case d.mi.update:case d.mi.resend:let o={reqOrdermId:this.data.data.reqOrdermId,lv:this.data.data.lv,act:this.data.operate==d.mi.update?"U":"R",reqDesc:this.reqDesc.value,effectiveDate:q(this.effectiveDate.value).format("YYYY/MM/DD"),apiOnOffD:this.converApiOnOffDataForUpdate(this.reqSubtype.value)},l=this.requisition.resendReq(o);this.close&&this.close(l)}}converApiOnOffData(t){let a={},o=new Object,l=new Object;switch(t){case"API_ON":case"API_ON_UPDATE":this.apiOnOffs.map(p=>{let s=new Array;for(let r of p.refThemeId)s.push({apiUid:p.apiUid,refThemeId:r});if(o[p.apiUid]=s,""!=p.fileName&&null!=p.fileName&&null==p.tempFileName)l[p.apiUid]=p.fileName;else{if(null==p.fileName&&null==p.tempFileName)return;l[p.apiUid]=p.tempFileName}});break;case"API_OFF":this.apiOffDataList.map(p=>{let s=new Array;Object.keys(p.themeDatas).map(r=>{s.push({apiUid:p.apiUid,refThemeId:parseInt(r)})}),o[p.apiUid]=s,p.fileName&&(l[p.apiUid]=p.fileName)})}return a.apiUidDatas=o,a.apiMapFileName=l,a.encPublicFlag=this.tool.Base64Encoder(this.tool.BcryptEncoder(this.encPublicFlag.value))+","+this.encPublicFlag.value,a}converApiOnOffDataForUpdate(t){console.log(t);let a={},o=new Object,l=new Object,p=new Object;switch(t){case"API_ON":case"API_ON_UPDATE":this.data.operate==d.mi.create?a.oriApiMapFileName={}:(this.data.data.apiOnOff.apiOnOffList.map(s=>{Object.keys(s.docFileInfo).length>0&&(l[s.apiUid]=Object.keys(s.docFileInfo)[0])}),a.oriApiMapFileName=l),this.apiOnOffs.map(s=>{let r=new Array;for(let c of s.refThemeId)r.push({apiUid:s.apiUid,refThemeId:c});if(o[s.apiUid]=r,""!=s.fileName&&null!=s.fileName&&null==s.tempFileName)p[s.apiUid]=s.fileName;else{if(null==s.fileName&&null==s.tempFileName)return;p[s.apiUid]=s.tempFileName}}),a.newApiMapFileName=p;break;case"API_OFF":this.apiOffDataList.map(s=>{console.log(s),p[s.apiUid]=s.fileName?s.fileName:null;let r=new Array;Object.keys(s.themeDatas).map(c=>{r.push({apiUid:s.apiUid,refThemeId:parseInt(c)})}),o[s.apiUid]=r}),this.oriApi.map(s=>{l[s.apiUid]=Object.keys(s.docFileInfo).length>0?Object.keys(s.docFileInfo)[0]:null}),a.oriApiMapFileName=l,a.newApiMapFileName=p}return a.apiUidDatas=o,a.encPublicFlag=this.tool.Base64Encoder(this.tool.BcryptEncoder(this.encPublicFlag.value))+","+this.encPublicFlag.value,a}checkLength(t,a){return Object.keys(t).length>1&&a+1!=Object.keys(t).length}downloadFile(t,a){this.file.downloadFile({filePath:t}).subscribe(l=>{const p=new FileReader;p.onloadend=function(){const s=new File([l],a),r=window.URL.createObjectURL(s),c=document.createElement("a");document.body.appendChild(c),c.setAttribute("style","display: none"),c.href=r,c.download=a,c.click(),window.URL.revokeObjectURL(r),c.remove()},p.readAsText(l)})}fileNameConvert(t){return t?decodeURIComponent(t):""}resetFormGroup(t){if(!t)return{reqSubtype:"",reqDesc:"",effectiveDate:"",encPublicFlag:""};switch(t){case d.mi.create:return{reqSubtype:new _.NI("API_ON",Z.np()),reqDesc:new _.NI("",Z.np()),effectiveDate:new _.NI(q(new Date).format("YYYY/MM/DD"),Z.np()),encPublicFlag:new _.NI("",Z.np())};case d.mi.update:case d.mi.resend:let a=this.data.data;return{reqSubtype:new _.NI({value:a.reqSubtype,disabled:!0},Z.np()),reqDesc:new _.NI(a.reqDesc,Z.np()),effectiveDate:new _.NI(a.effectiveDate,Z.np()),encPublicFlag:new _.NI(a.apiOnOff.publicFlag,Z.np())};default:return{reqSubtype:"",reqDesc:"",effectiveDate:"",encPublicFlag:""}}}get reqSubtype(){return this.form.get("reqSubtype")}get reqDesc(){return this.form.get("reqDesc")}get effectiveDate(){return this.form.get("effectiveDate")}get encPublicFlag(){return this.form.get("encPublicFlag")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.qu),e.Y36(w.g),e.Y36(e._Vd),e.Y36(D.A),e.Y36(x.F0),e.Y36(T.ez),e.Y36(B.X),e.Y36(M.p),e.Y36(F.I),e.Y36(S.LA),e.Y36(P.H),e.Y36(y.xA))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-api-on-off"]],viewQuery:function(t,a){if(1&t&&(e.Gf(Ee,5),e.Gf(Be,5,e.s_b),e.Gf($e,5)),2&t){let o;e.iGM(o=e.CRH())&&(a._dialog=o.first),e.iGM(o=e.CRH())&&(a.apiShelvesRef=o.first),e.iGM(o=e.CRH())&&(a.content=o.first)}},inputs:{data:"data",close:"close"},features:[e._Bn([T.ez])],decls:64,vars:46,consts:[[1,"card","card-body","bg-light","mt-3"],[3,"formGroup"],[1,"form-group","row"],[1,"col-4","col-xl-4","col-lg-4"],[1,"control-label"],[4,"ngIf"],[1,"required","control-label"],["class","form-check-inline",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],["dateFormat","yy/mm/dd","appendTo","body","formControlName","effectiveDate",3,"showIcon","readonlyInput","minDate"],[1,"col-12","col-xl-12","col-lg-12"],["rows","5","formControlName","reqDesc",1,"form-control"],["style","word-break:break-word;",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","tpi-btn","tpi-primary","mt-2",3,"disabled","click"],[3,"title"],["dialog",""],["position","top-left"],[1,"form-check-inline"],[1,"form-check-label"],["type","radio","formControlName","reqSubtype",1,"form-check-input",3,"value"],[1,"text-danger"],[1,"form-text"],["type","radio","formControlName","encPublicFlag",1,"form-check-input",3,"value"],[1,"col-12","col-lg-12","col-sm-12"],[1,"row"],[1,"col-3","col-lg-3","col-sm-3"],[1,"col-4","col-lg-4","col-sm-4"],[2,"opacity","0.7"],[1,"hosts"],["apiShelves",""],["type","button",1,"btn","tpi-btn","tpi-second",3,"click"],[2,"word-break","break-word"],[1,"col-6","col-lg-6","col-xl-6","col-sm-6"],[1,"ui-inputgroup"],["type","text",1,"form-control",3,"placeholder","ngModel","ngModelChange"],["pButton","","type","button","icon","pi pi-search",1,"tpi-night",3,"click"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","selection","style","selectionChange",4,"ngIf"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","selection","selectionChange"],["pTemplate","caption"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[1,"ui-helper-clearfix"],["type","button",1,"btn","tpi-btn","tpi-primary","float-start",3,"click"],[2,"width","2.25em"],[3,"width",4,"ngFor","ngForOf"],["scope","col",2,"width","2.25em"],["scope","col",3,"width",4,"ngFor","ngForOf"],["scope","col"],[3,"value"],[4,"ngFor","ngForOf"],["href","javascript:void(0)",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._uU(7,"\uff1a "),e.YNc(8,Me,2,1,"label",5),e.YNc(9,je,2,1,"label",5),e.qZA(),e.TgZ(10,"div",3)(11,"label",4),e._uU(12),e.ALo(13,"translate"),e.qZA(),e._uU(14,"\uff1a "),e.YNc(15,He,2,1,"label",5),e.YNc(16,ze,2,1,"label",5),e.qZA(),e.TgZ(17,"div",3)(18,"label",4),e._uU(19),e.ALo(20,"translate"),e.qZA(),e._uU(21,"\uff1a "),e.YNc(22,Ve,2,1,"label",5),e.YNc(23,Ge,2,1,"label",5),e.qZA()(),e.TgZ(24,"div",2)(25,"div",3)(26,"label",6),e._uU(27),e.ALo(28,"translate"),e.qZA(),e._uU(29,"\uff1a "),e.YNc(30,Ke,4,2,"div",7),e.YNc(31,Xe,4,3,"div",8),e.qZA(),e.TgZ(32,"div",3)(33,"label",6),e._uU(34),e.ALo(35,"translate"),e.qZA(),e._uU(36,"\uff1a "),e.YNc(37,We,4,2,"div",7),e.YNc(38,et,4,3,"div",8),e.qZA(),e.TgZ(39,"div",3)(40,"label",6),e._uU(41),e.ALo(42,"translate"),e.qZA(),e._uU(43,"\uff1a "),e._UZ(44,"p-calendar",9),e.YNc(45,tt,4,3,"div",8),e.qZA()(),e.TgZ(46,"div",2)(47,"div",10)(48,"label",6),e._uU(49),e.ALo(50,"translate"),e.qZA(),e._uU(51,"\uff1a "),e._UZ(52,"textarea",11),e.YNc(53,it,4,3,"div",8),e.qZA()()(),e._UZ(54,"hr"),e.YNc(55,nt,26,18,"div",5),e.YNc(56,Zt,8,5,"div",12),e.YNc(57,yt,29,19,"div",5),e.TgZ(58,"div",13)(59,"button",14),e.NdJ("click",function(){return a.submitForm()}),e._uU(60),e.qZA()()(),e._UZ(61,"app-dialog",15,16)(63,"p-toast",17)),2&t&&(e.xp6(1),e.Q6J("formGroup",a.form),e.xp6(4),e.Oqu(e.lcZ(6,31,"apply_date")),e.xp6(3),e.Q6J("ngIf",a.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.data.operate!=a.formOperate.create),e.xp6(3),e.Oqu(e.lcZ(13,33,"apply_user")),e.xp6(3),e.Q6J("ngIf",a.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.data.operate!=a.formOperate.create),e.xp6(3),e.Oqu(e.lcZ(20,35,"apply_org")),e.xp6(3),e.Q6J("ngIf",a.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.data.operate!=a.formOperate.create),e.xp6(4),e.Oqu(e.lcZ(28,37,"req_sub_type")),e.xp6(3),e.Q6J("ngForOf",a.subTypes),e.xp6(1),e.Q6J("ngIf",(null==a.reqSubtype?null:a.reqSubtype.invalid)&&((null==a.reqSubtype?null:a.reqSubtype.dirty)||(null==a.reqSubtype?null:a.reqSubtype.touched))),e.xp6(3),e.Oqu(e.lcZ(35,39,"public_flag")),e.xp6(3),e.Q6J("ngForOf",a.publicFlags),e.xp6(1),e.Q6J("ngIf",(null==a.encPublicFlag?null:a.encPublicFlag.invalid)&&((null==a.encPublicFlag?null:a.encPublicFlag.dirty)||(null==a.encPublicFlag?null:a.encPublicFlag.touched))),e.xp6(3),e.Oqu(e.lcZ(42,41,"effective_date")),e.xp6(3),e.Q6J("showIcon",!0)("readonlyInput",!0)("minDate",a.minDateValue),e.xp6(1),e.Q6J("ngIf",(null==a.effectiveDate?null:a.effectiveDate.invalid)&&((null==a.effectiveDate?null:a.effectiveDate.dirty)||(null==a.effectiveDate?null:a.effectiveDate.touched))),e.xp6(4),e.Oqu(e.lcZ(50,43,"apply_desc")),e.xp6(4),e.Q6J("ngIf",(null==a.reqDesc?null:a.reqDesc.invalid)&&((null==a.reqDesc?null:a.reqDesc.dirty)||(null==a.reqDesc?null:a.reqDesc.touched))),e.xp6(2),e.Q6J("ngIf","API_ON"==a.reqSubtype.value),e.xp6(1),e.Q6J("ngIf","API_OFF"==a.reqSubtype.value),e.xp6(1),e.Q6J("ngIf","API_ON_UPDATE"==a.reqSubtype.value),e.xp6(2),e.Q6J("disabled","API_OFF"!=a.reqSubtype.value&&a.isInvalid||a.form.invalid),e.xp6(1),e.Oqu(a.btnName),e.xp6(1),e.Q6J("title",a.dialogTitle),e.xp6(2),e.Akn(e.DdM(45,Nt)))},directives:[_._Y,_.JL,_.sg,g.O5,g.sg,_._,_.Fj,_.JJ,_.u,E.f,_.On,C.Hq,A.iA,T.jx,A.Mo,A.UA,J.a,Q.FN],pipes:[N.X$,g.Nd],styles:[""]}),i})();var j=u(56435),H=u(4119);const Ot=["dialog"];function Ct(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.createDateTime)}}function Dt(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.createDateTime)}}function Ft(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.orgName)}}function It(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.orgName)}}function Ut(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"small",29),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"small",29),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,t.effectiveDate.errors.isRequired)),e.xp6(3),e.Oqu(e.lcZ(6,4,t.effectiveDate.errors.maxlength))}}function kt(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.clientID)}}function Lt(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.apiUserApply.clientId)}}function Rt(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.clientName)}}function Yt(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.apiUserApply.clientName)}}function Jt(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.clientAlias)}}function Qt(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.config.data.data.apiUserApply.clientAlias)}}function Pt(i,n){1&i&&(e.TgZ(0,"label",30),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"apply_desc")))}function St(i,n){1&i&&(e.TgZ(0,"label",31),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"new_apply_desc")))}function Et(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"small",29),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"small",29),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,t.reqDesc.errors.isRequired)),e.xp6(3),e.Oqu(e.lcZ(6,4,t.reqDesc.errors.maxlength))}}function Bt(i,n){1&i&&(e.TgZ(0,"label",4),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"application_file")))}function $t(i,n){1&i&&(e.TgZ(0,"label",4),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"new_application_file")))}function Mt(i,n){if(1&i&&(e.TgZ(0,"div",9)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.AsE("",e.lcZ(3,2,"ori_application_file"),"\uff1a",t.oriFileName.value,"")}}function jt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",39)(1,"button",40),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).delete()}),e._uU(2),e.ALo(3,"translate"),e.qZA()()}2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"button.delete")," "))}function Ht(i,n){1&i&&e._UZ(0,"col"),2&i&&e.Udp("width",n.$implicit.width)}function zt(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e._UZ(1,"col",41),e.YNc(2,Ht,1,2,"col",42),e.qZA()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("ngForOf",t)}}function Vt(i,n){if(1&i&&(e.TgZ(0,"th",45),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",t.header," ")}}function Gt(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"th",43),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.YNc(3,Vt,2,3,"th",44),e.qZA()),2&i){const t=n.$implicit;e.xp6(3),e.Q6J("ngForOf",t)}}function Kt(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.lnq(" (",t.apiKey,",",t.moduleName,") - ",t.apiName," ")}}function Xt(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.Oqu(a[t.field])}}function Wt(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"\uff0c"),e.qZA())}function ei(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Wt,2,0,"span",5),e.qZA()),2&i){const t=n.$implicit,a=n.index,o=e.oxw(2).$implicit,l=e.oxw().$implicit,p=e.oxw(2);e.xp6(1),e.hij(" ",t.value," "),e.xp6(1),e.Q6J("ngIf",p.checkLength(l[o.field],a))}}function ti(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ei,3,2,"span",47),e.ALo(2,"keyvalue"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a[t.field]))}}function ii(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span")(1,"a",48),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(2).downloadFile(o.filePath,o.fileName)}),e._uU(2),e.qZA()()}if(2&i){const t=e.oxw(2).$implicit,a=e.oxw(2);e.xp6(2),e.hij(" ",a.fileNameConvert(t.fileName)," ")}}function ai(i,n){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,Kt,2,3,"span",5),e.YNc(2,Xt,2,1,"span",5),e.YNc(3,ti,3,3,"div",5),e.YNc(4,ii,3,1,"span",5),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.Q6J("ngIf","apiName"==t.field),e.xp6(1),e.Q6J("ngIf","apiName"!=t.field&&"themeDatas"!=t.field&&"fileName"!=t.field),e.xp6(1),e.Q6J("ngIf","themeDatas"==t.field),e.xp6(1),e.Q6J("ngIf","fileName"==t.field)}}function ni(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",46),e.qZA(),e.YNc(3,ai,5,6,"td",42),e.qZA()),2&i){const t=n.$implicit,a=n.columns;e.xp6(2),e.Q6J("value",t),e.xp6(1),e.Q6J("ngForOf",a)}}function oi(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.AsE("",e.lcZ(3,3,"row_count"),": ",a.rowcount,"")}}function li(i,n){if(1&i&&e.YNc(0,oi,4,5,"tr",5),2&i){const t=e.oxw(2);e.Q6J("ngIf",t.rowcount)}}function si(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"no_rec")," ")}}const pi=function(){return{"word-break":"break-word"}};function ci(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"p-table",32),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().selectedApis=o}),e.YNc(1,jt,4,3,"ng-template",33),e.YNc(2,zt,3,1,"ng-template",34),e.YNc(3,Gt,4,1,"ng-template",35),e.YNc(4,ni,4,2,"ng-template",36),e.YNc(5,li,1,1,"ng-template",37),e.YNc(6,si,4,4,"ng-template",38),e.qZA()}if(2&i){const t=e.oxw();e.Akn(e.DdM(5,pi)),e.Q6J("columns",t.cols)("value",t.authApiList)("selection",t.selectedApis)}}const ri=function(){return{marginTop:"60px"}};let _i=(()=>{class i extends O.H{constructor(t,a,o,l,p,s,r,c,m,f,h,v,I){super(t,a),this.fb=o,this.tool=l,this.lov=p,this.file=s,this.message=r,this.ngxService=c,this.requisition=m,this.orgService=f,this.ref=h,this.config=v,this.dialogService=I,this.minDateValue=new Date,this.createDateTime="",this.btnName="",this.formOperate=d.mi,this.dialogTitle="",this.selectedApis=new Array,this.cols=[],this.authApiList=new Array,this.rowcount=0,this.orgName="",this.fileName=""}ngOnInit(){var t=this;return(0,b.Z)(function*(){t.form=t.fb.group(t.resetFormGroup(t.config.data.operate));const o=yield t.tool.getDict(["button.save","api_desc","dept","button.update","button.resend","api_name","theme_name","api_doc","api_audience"]);switch(t.cols=[{field:"apiName",header:o.api_name},{field:"apiDesc",header:o.api_desc},{field:"publicFlagName",header:o.api_audience},{field:"orgName",header:o.dept},{field:"themeDatas",header:o.theme_name},{field:"fileName",header:o.api_doc}],t.config.data.operate){case d.mi.create:t.btnName=o["button.save"],t.createDateTime=q(new Date).format("YYYY/MM/DD"),t.orgService.queryTOrgList({orgID:t.tool.getOrgId()}).subscribe(l=>{t.tool.checkDpSuccess(l.ResHeader)&&(t.orgName=l.RespBody.orgList[0].orgName)});break;case d.mi.update:case d.mi.resend:t.btnName=t.config.data.operate==d.mi.update?o["button.update"]:o["button.resend"],t.config.data.data.apiUserApply.apiList.map(l=>{let p=Object.keys(l.docFileInfo)[0];t.authApiList.push({apiUid:l.apiUid,apiName:l.apiName,moduleName:l.moduleName,themeDatas:l.themeList,orgName:l.orgName,fileName:p,filePath:l.docFileInfo[p],apiDesc:l.apiDesc,publicFlag:l.publicFlag,publicFlagName:l.publicFlagName})}),t.rowcount=t.authApiList.length}t.requisition.createReq_beforer().subscribe(l=>{t.tool.checkDpSuccess(l.ResHeader)&&t.addFormValidator(t.form,l.RespBody.constraints)})})()}fileChange(t){var a=this;return(0,b.Z)(function*(){const l=yield a.tool.getDict(["uploading","cfm_img_format","cfm_size","message.success","upload_result","waiting"]);if(0!=t.length){let p=new FileReader;p.onloadend=()=>{a.message.add({severity:"success",summary:l.upload_result,detail:`${l["message.success"]}!`}),a.fileData.setValue(t.item(0))},p.readAsBinaryString(t.item(0)),a.fileName=t[0].name}else a.fileData.setValue(null)})()}searchAPI(){var t=this;this.lov.queryApiLov({keyword:this.keyword.value,dpStatus:"1"}).subscribe(function(){var o=(0,b.Z)(function*(l){if(t.tool.checkDpSuccess(l.ResHeader)){const p=["on_shelves_api_search"];yield t.tool.getDict(p),t.dialogService.open(Y,{data:{data:{dpStatus:"1",selectedApis:t.authApiList,apiList:l.RespBody.dataList,selectionMode:"multiple",keyword:t.keyword.value}}}).onClose.subscribe(c=>{c&&(t.keyword.setValue(""),t.authApiList=c,t.rowcount=t.authApiList.length)})}});return function(l){return o.apply(this,arguments)}}())}checkLength(t,a){return Object.keys(t).length>1&&a+1!=Object.keys(t).length}fileNameConvert(t){return t?decodeURIComponent(t):""}downloadFile(t,a){this.file.downloadFile({filePath:t}).subscribe(l=>{const p=new FileReader;p.onloadend=function(){const s=new File([l],a),r=window.URL.createObjectURL(s),c=document.createElement("a");document.body.appendChild(c),c.setAttribute("style","display: none"),c.href=r,c.download=a,c.click(),window.URL.revokeObjectURL(r),c.remove()},p.readAsText(l)})}delete(){this.selectedApis.map(t=>{this.authApiList=this.authApiList.filter(a=>a.apiUid!=t.apiUid)}),this.selectedApis=[],this.rowcount=this.authApiList.length}submitForm(){switch(this.config.data.operate){case d.mi.create:this.fileData.value?window.setTimeout(()=>{this.file.uploadFile2(this.fileData.value).subscribe(t=>{this.tool.checkDpSuccess(t.ResHeader)&&(this.tmpFileName.setValue(t.RespBody.tempFileName),this.createRequisition())})}):(this.tmpFileName.setValue(null),this.createRequisition());break;case d.mi.update:case d.mi.resend:this.fileData.value?window.setTimeout(()=>{this.file.uploadFile2(this.fileData.value).subscribe(t=>{this.tool.checkDpSuccess(t.ResHeader)&&(this.tmpFileName.setValue(t.RespBody.tempFileName),this.updateOrResendRequisition())})}):(this.tmpFileName.setValue(null),this.updateOrResendRequisition())}}createRequisition(){var t=this;let a={reqType:"API_APPLICATION",effectiveDate:q(this.effectiveDate.value).format("YYYY/MM/DD"),reqDesc:this.reqDesc.value},o={clientId:this.config.data.data.clientID,apiUids:this.convertApiUids()};this.tmpFileName.value&&(o.tmpFileName=this.tmpFileName.value),a.apiApplicationD=o,this.ngxService.start(),this.requisition.createReq(a).subscribe(function(){var l=(0,b.Z)(function*(p){if(t.tool.checkDpSuccess(p.ResHeader)){t.ngxService.stop();const s=["message.save","message.requisition.client_auth_api","message.success"],r=yield t.tool.getDict(s);t.message.add({severity:"success",summary:`${r["message.save"]} ${r["message.requisition.client_auth_api"]}`,detail:`${r["message.save"]} ${r["message.success"]}!`}),t.form.reset(),t.form=t.fb.group(t.resetFormGroup(t.config.data.operate));const c=document.getElementById("file");c&&(c.value=""),t.authApiList=[],t.rowcount=t.authApiList.length}});return function(p){return l.apply(this,arguments)}}())}updateOrResendRequisition(){let t={reqOrdermId:this.config.data.data.reqOrdermId,lv:this.config.data.data.lv,act:this.config.data.operate==d.mi.update?"U":"R",reqDesc:this.reqDesc.value,effectiveDate:q(this.effectiveDate.value).format("YYYY/MM/DD")},a={clientId:this.config.data.data.apiUserApply.clientId,apiUids:this.convertApiUids(),newFileName:this.tmpFileName.value?this.tmpFileName.value:this.oriFileName.value,oriFileName:this.oriFileName.value};t.apiApplicationD=a,this.requisition.resendReq(t).subscribe(o=>{this.tool.checkDpSuccess(o.ResHeader)&&this.ref.close(o.RespBody)})}convertApiUids(){let t=[];return this.authApiList.map(a=>{t.push(a.apiUid)}),t}resetFormGroup(t){if(!t)return{reqDesc:"",effectiveDate:"",fileData:"",oriFileName:"",tmpFileName:""};switch(t){case d.mi.create:return{reqDesc:new _.NI("",Z.np()),effectiveDate:new _.NI(q(new Date).format("YYYY/MM/DD"),Z.np()),fileData:new _.NI(null),oriFileName:new _.NI(""),tmpFileName:new _.NI(""),keyword:new _.NI("")};case d.mi.update:case d.mi.resend:let a=this.config.data.data;return{reqDesc:new _.NI(a.reqDesc,Z.np()),effectiveDate:new _.NI(a.effectiveDate,Z.np()),fileData:new _.NI(null),oriFileName:new _.NI(a.apiUserApply.fileName),tmpFileName:new _.NI(""),keyword:new _.NI("")};default:return{reqDesc:"",effectiveDate:"",fileData:"",oriFileName:"",tmpFileName:""}}}openFileBrowser(){$("#file").click()}get effectiveDate(){return this.form.get("effectiveDate")}get reqDesc(){return this.form.get("reqDesc")}get keyword(){return this.form.get("keyword")}get fileData(){return this.form.get("fileData")}get oriFileName(){return this.form.get("oriFileName")}get tmpFileName(){return this.form.get("tmpFileName")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(x.gz),e.Y36(j.W),e.Y36(_.qu),e.Y36(w.g),e.Y36(D.A),e.Y36(F.I),e.Y36(T.ez),e.Y36(S.LA),e.Y36(P.H),e.Y36(M.p),e.Y36(y.E7),e.Y36(y.S),e.Y36(y.xA))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-client-authorize-api"]],viewQuery:function(t,a){if(1&t&&e.Gf(Ot,5),2&t){let o;e.iGM(o=e.CRH())&&(a._dialog=o.first)}},inputs:{data:"data",close:"close"},features:[e.qOj],decls:83,vars:59,consts:[[1,"card","card-body","bg-light","mt-3"],[3,"formGroup"],[1,"form-group","row"],[1,"col-4","col-xl-4","col-lg-4"],[1,"control-label"],[4,"ngIf"],[1,"required","control-label"],["dateFormat","yy/mm/dd","appendTo","body","formControlName","effectiveDate","id","effectiveDate",3,"showIcon","readonlyInput","minDate"],["class","text-danger",4,"ngIf"],[1,"col-12","col-xl-12","col-lg-12"],["id","reqDesc_label","for","reqDesc","class","required control-label",4,"ngIf"],["id","reqDesc_label","for","reqDesc","class","control-label",4,"ngIf"],["rows","5","formControlName","reqDesc","id","reqDesc",1,"form-control"],["class","control-label",4,"ngIf"],[1,"ui-inputgroup"],["type","file","id","file",2,"display","none",3,"change"],["type","text","readOnly","",1,"form-control",3,"value","placeholder"],["pButton","","type","button","icon","pi pi-file","tooltipPosition","top",1,"ms-1","tpi-primary",3,"pTooltip","click"],["class","col-12 col-xl-12 col-lg-12",4,"ngIf"],[1,"ui-inputgroup","mb-1"],["type","text","formControlName","keyword",1,"form-control",3,"placeholder"],["pButton","","type","button","icon","pi pi-search",1,"tpi-night","ms-1",3,"click"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","selection","style","selectionChange",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","tpi-btn","tpi-primary","mt-2",3,"disabled","click"],[3,"title"],["dialog",""],["position","top-left"],[1,"text-danger"],[1,"form-text"],["id","reqDesc_label","for","reqDesc",1,"required","control-label"],["id","reqDesc_label","for","reqDesc",1,"control-label"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","selection","selectionChange"],["pTemplate","caption"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[1,"ui-helper-clearfix"],["type","button",1,"btn","tpi-btn","tpi-primary","float-start",3,"click"],[2,"width","2.25em"],[3,"width",4,"ngFor","ngForOf"],["scope","col",2,"width","2.25em"],["scope","col",3,"width",4,"ngFor","ngForOf"],["scope","col"],[3,"value"],[4,"ngFor","ngForOf"],["href","javascript:void(0)",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._uU(7,"\uff1a "),e.YNc(8,Ct,2,1,"label",5),e.YNc(9,Dt,2,1,"label",5),e.qZA(),e.TgZ(10,"div",3)(11,"label",4),e._uU(12),e.ALo(13,"translate"),e.qZA(),e._uU(14,"\uff1a "),e.YNc(15,Ft,2,1,"label",5),e.YNc(16,It,2,1,"label",5),e.qZA(),e.TgZ(17,"div",3)(18,"label",6),e._uU(19),e.ALo(20,"translate"),e.qZA(),e._uU(21,"\uff1a "),e._UZ(22,"p-calendar",7),e.YNc(23,Ut,7,6,"div",8),e.qZA()(),e.TgZ(24,"div",2)(25,"div",3)(26,"label",4),e._uU(27),e.ALo(28,"translate"),e.qZA(),e._uU(29,"\uff1a "),e.YNc(30,kt,2,1,"label",5),e.YNc(31,Lt,2,1,"label",5),e.qZA(),e.TgZ(32,"div",3)(33,"label",4),e._uU(34),e.ALo(35,"translate"),e.qZA(),e._uU(36,"\uff1a "),e.YNc(37,Rt,2,1,"label",5),e.YNc(38,Yt,2,1,"label",5),e.qZA(),e.TgZ(39,"div",3)(40,"label",4),e._uU(41),e.ALo(42,"translate"),e.qZA(),e._uU(43,"\uff1a "),e.YNc(44,Jt,2,1,"label",5),e.YNc(45,Qt,2,1,"label",5),e.qZA()(),e.TgZ(46,"div",2)(47,"div",9),e.YNc(48,Pt,3,3,"label",10),e.YNc(49,St,3,3,"label",11),e._uU(50,"\uff1a "),e._UZ(51,"textarea",12),e.YNc(52,Et,7,6,"div",8),e.qZA()(),e.TgZ(53,"div",2)(54,"div",9),e.YNc(55,Bt,3,3,"label",13),e.YNc(56,$t,3,3,"label",13),e._uU(57,"\uff1a "),e.TgZ(58,"div",14)(59,"input",15),e.NdJ("change",function(l){return a.fileChange(l.target.files)}),e.qZA(),e._UZ(60,"input",16),e.ALo(61,"translate"),e.TgZ(62,"button",17),e.NdJ("click",function(){return a.openFileBrowser()}),e.ALo(63,"translate"),e.qZA()()(),e.YNc(64,Mt,4,4,"div",18),e.qZA(),e.TgZ(65,"div",2)(66,"div",9)(67,"label",6),e._uU(68),e.ALo(69,"translate"),e.qZA(),e._uU(70,"\uff1a "),e.TgZ(71,"div",19),e._UZ(72,"input",20),e.ALo(73,"translate"),e.TgZ(74,"button",21),e.NdJ("click",function(){return a.searchAPI()}),e.qZA()(),e.YNc(75,ci,7,6,"p-table",22),e.qZA()()(),e._UZ(76,"hr"),e.TgZ(77,"div",23)(78,"button",24),e.NdJ("click",function(){return a.submitForm()}),e._uU(79),e.qZA()()(),e._UZ(80,"app-dialog",25,26)(82,"p-toast",27)),2&t&&(e.xp6(1),e.Q6J("formGroup",a.form),e.xp6(4),e.Oqu(e.lcZ(6,38,"apply_date")),e.xp6(3),e.Q6J("ngIf",a.config.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create),e.xp6(3),e.Oqu(e.lcZ(13,40,"apply_org")),e.xp6(3),e.Q6J("ngIf",a.config.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create),e.xp6(3),e.Oqu(e.lcZ(20,42,"effective_date")),e.xp6(3),e.Q6J("showIcon",!0)("readonlyInput",!0)("minDate",a.minDateValue),e.xp6(1),e.Q6J("ngIf",(null==a.effectiveDate?null:a.effectiveDate.invalid)&&((null==a.effectiveDate?null:a.effectiveDate.dirty)||(null==a.effectiveDate?null:a.effectiveDate.touched))),e.xp6(4),e.Oqu(e.lcZ(28,44,"client_id")),e.xp6(3),e.Q6J("ngIf",a.config.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create),e.xp6(3),e.Oqu(e.lcZ(35,46,"client_name")),e.xp6(3),e.Q6J("ngIf",a.config.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create),e.xp6(3),e.Oqu(e.lcZ(42,48,"client_alias")),e.xp6(3),e.Q6J("ngIf",a.config.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create),e.xp6(3),e.Q6J("ngIf",a.config.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create),e.xp6(3),e.Q6J("ngIf",(null==a.reqDesc?null:a.reqDesc.invalid)&&((null==a.reqDesc?null:a.reqDesc.dirty)||(null==a.reqDesc?null:a.reqDesc.touched))),e.xp6(3),e.Q6J("ngIf",a.config.data.operate==a.formOperate.create),e.xp6(1),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create),e.xp6(4),e.s9C("value",a.fileName),e.s9C("placeholder",e.lcZ(61,50,"upload_file")),e.xp6(2),e.Q6J("pTooltip",e.lcZ(63,52,"upload_file")),e.xp6(2),e.Q6J("ngIf",a.config.data.operate!=a.formOperate.create&&(null==a.oriFileName?null:a.oriFileName.value)),e.xp6(4),e.Oqu(e.lcZ(69,54,"choose_api")),e.xp6(4),e.s9C("placeholder",e.lcZ(73,56,"keyword_search")),e.xp6(3),e.Q6J("ngIf",a.cols),e.xp6(3),e.Q6J("disabled",a.form.invalid||0==a.authApiList.length),e.xp6(1),e.Oqu(a.btnName),e.xp6(1),e.Q6J("title",a.dialogTitle),e.xp6(2),e.Akn(e.DdM(58,ri)))},directives:[_._Y,_.JL,_.sg,g.O5,E.f,_.JJ,_.u,_.Fj,C.Hq,H.u,A.iA,T.jx,g.sg,A.Mo,A.UA,J.a,Q.FN],pipes:[N.X$,g.Nd],styles:[""]}),i})();function di(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"public_flag"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.apiOnOff.publicFlagName)}}function ui(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return o.downloadFile(o.data.data.detailData.clientReg.filePath,o.data.data.detailData.clientReg.fileName)}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.data.data.detailData.clientReg.fileName," ")}}function mi(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return o.downloadFile(o.data.data.detailData.apiUserApply.filePath,o.data.data.detailData.apiUserApply.fileName)}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.data.data.detailData.apiUserApply.fileName," ")}}function fi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,ui,2,1,"a",11),e.YNc(5,mi,2,1,"a",11),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,3,"application_file"),"\uff1a"),e.xp6(2),e.Q6J("ngIf","CLIENT_REG"==t.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","API_APPLICATION"==t.data.data.detailData.reqType)}}function hi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"client_id"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.clientReg.clientId)}}function gi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"client_name"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.clientReg.clientName)}}function bi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"emails"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.clientReg.emails)}}function vi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"public_flag"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.clientReg.publicFlagName)}}function Ai(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"client_id"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.apiUserApply.clientId)}}function Ti(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"client_name"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.apiUserApply.clientName)}}function qi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"client_alias"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.apiUserApply.clientAlias)}}function Zi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"client_id"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.openApiKey.clientId)}}function xi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"client_name"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.openApiKey.clientName)}}function yi(i,n){if(1&i&&(e.TgZ(0,"div",6)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"open_api_key_alias"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.openApiKey.openApiKeyAlias)}}function Ni(i,n){if(1&i&&(e.TgZ(0,"div",6)(1,"label",4),e._uU(2,"Open API Key\uff1a"),e.qZA(),e.TgZ(3,"label"),e._uU(4),e.qZA()()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.data.data.detailData.openApiKey.openApiKey)}}function wi(i,n){if(1&i&&(e.TgZ(0,"div",6)(1,"label",4),e._uU(2,"Secret Key\uff1a"),e.qZA(),e.TgZ(3,"label"),e._uU(4),e.qZA()()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.data.data.detailData.openApiKey.secretKey)}}function Oi(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"expired_date"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.openApiKey.expiredAt)}}function Ci(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"label",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"times_threshold"),"\uff1a"),e.xp6(3),e.Oqu(t.data.data.detailData.openApiKey.timesThreshold)}}function Di(i,n){1&i&&e._UZ(0,"col"),2&i&&e.Udp("width",n.$implicit.width)}function Fi(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e._UZ(1,"col",18),e.qZA(),e.TgZ(2,"colgroup"),e.YNc(3,Di,1,2,"col",19),e.qZA()),2&i){const t=n.$implicit;e.xp6(3),e.Q6J("ngForOf",t)}}function Ii(i,n){if(1&i&&(e.TgZ(0,"th",22),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",t.header," ")}}function Ui(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"th",20),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Ii,2,3,"th",21),e.qZA()),2&i){const t=n.$implicit;e.xp6(2),e.hij(" ",e.lcZ(3,2,"sort")," "),e.xp6(2),e.Q6J("ngForOf",t)}}function ki(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.lnq(" (",t.apiKey,",",t.moduleName,") - ",t.apiName," ")}}function Li(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.hij(" ",a[t.field]," ")}}function Ri(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"\uff0c"),e.qZA())}function Yi(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Ri,2,0,"span",23),e.qZA()),2&i){const t=n.$implicit,a=n.index,o=e.oxw(2).$implicit,l=e.oxw().$implicit,p=e.oxw(3);e.xp6(1),e.hij(" ",t.value," "),e.xp6(1),e.Q6J("ngIf",p.checkLength(l[o.field],a))}}function Ji(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Yi,3,2,"span",24),e.ALo(2,"keyvalue"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a[t.field]))}}function Qi(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"\uff0c"),e.qZA())}function Pi(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",12),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw(6).downloadFile(l.value,l.key)}),e._uU(1),e.YNc(2,Qi,2,0,"span",23),e.qZA()}if(2&i){const t=n.$implicit,a=n.index,o=e.oxw(2).$implicit,l=e.oxw().$implicit,p=e.oxw(3);e.xp6(1),e.hij(" ",t.key," "),e.xp6(1),e.Q6J("ngIf",p.checkLength(l[o.field],a))}}function Si(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Pi,3,2,"a",25),e.ALo(2,"keyvalue"),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a[t.field]))}}function Ei(i,n){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,ki,2,3,"span",23),e.YNc(2,Li,2,1,"span",23),e.YNc(3,Ji,3,3,"div",23),e.YNc(4,Si,3,3,"div",23),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.Q6J("ngIf","apiName"==t.field),e.xp6(1),e.Q6J("ngIf","apiName"!=t.field&&"themeList"!=t.field&&"docFileInfo"!=t.field),e.xp6(1),e.Q6J("ngIf","themeList"==t.field),e.xp6(1),e.Q6J("ngIf","docFileInfo"==t.field)}}function Bi(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",18)(2,"span"),e._uU(3),e.qZA()(),e.YNc(4,Ei,5,6,"td",19),e.qZA()),2&i){const t=n.columns,a=n.rowIndex;e.xp6(3),e.hij(" ",a+1," "),e.xp6(1),e.Q6J("ngForOf",t)}}const z=function(){return{"word-break":"break-word"}};function $i(i,n){if(1&i&&(e.TgZ(0,"p-table",14),e.YNc(1,Fi,4,1,"ng-template",15),e.YNc(2,Ui,5,4,"ng-template",16),e.YNc(3,Bi,5,2,"ng-template",17),e.qZA()),2&i){const t=e.oxw(2);e.Akn(e.DdM(4,z)),e.Q6J("columns",t.detailCols)("value",t.detailDataList)}}function Mi(i,n){if(1&i&&(e.TgZ(0,"div",6),e.YNc(1,$i,4,5,"p-table",13),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.detailCols)}}function ji(i,n){1&i&&e._UZ(0,"col"),2&i&&e.Udp("width",n.$implicit.width)}function Hi(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e.YNc(1,ji,1,2,"col",19),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function zi(i,n){if(1&i&&(e.TgZ(0,"th",22),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",t.header," ")}}function Vi(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,zi,2,3,"th",21),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function Gi(i,n){if(1&i&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&i){const t=n.$implicit,a=e.oxw().$implicit;e.Udp("width",t.width),e.xp6(1),e.hij(" ",a[t.field]," ")}}function Ki(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,Gi,2,3,"td",19),e.qZA()),2&i){const t=n.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function Xi(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",30)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).moreData()}),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"i",32),e.qZA()()()}if(2&i){const t=e.oxw().$implicit,a=e.oxw(3);e.xp6(1),e.uIk("colspan",t.length),e.xp6(2),e.AsE("",e.lcZ(4,4,"row_count"),": ",a.rowcount,""),e.xp6(3),e.hij("",e.lcZ(7,6,"button.more")," ")}}function Wi(i,n){if(1&i&&e.YNc(0,Xi,9,8,"tr",23),2&i){const t=e.oxw(3);e.Q6J("ngIf",t.rowcount)}}function ea(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.uIk("colspan",t.length),e.xp6(1),e.hij(" ",e.lcZ(3,2,"no_rec")," ")}}function ta(i,n){if(1&i&&(e.TgZ(0,"p-table",27),e.YNc(1,Hi,2,1,"ng-template",15),e.YNc(2,Vi,2,1,"ng-template",16),e.YNc(3,Ki,2,1,"ng-template",17),e.YNc(4,Wi,1,1,"ng-template",28),e.YNc(5,ea,4,4,"ng-template",29),e.qZA()),2&i){const t=e.oxw(2);e.Akn(e.DdM(5,z)),e.Q6J("columns",t.trakerCols)("value",t.trakerDataList)("scrollable",!0)}}function ia(i,n){if(1&i&&(e.TgZ(0,"div",2)(1,"div",6)(2,"label",4),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",6),e.YNc(6,ta,6,6,"p-table",26),e.qZA()()),2&i){const t=e.oxw();e.xp6(3),e.hij("",e.lcZ(4,2,"dialog.approval_history"),"\uff1a"),e.xp6(3),e.Q6J("ngIf",t.trakerCols)}}function aa(i,n){1&i&&(e.TgZ(0,"div",2)(1,"div",6)(2,"label",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"textarea",33),e.qZA()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"sign_off_comment")))}let na=(()=>{class i{constructor(t,a,o,l){this.fb=t,this.file=a,this.tool=o,this.requisition=l,this.change=new e.vpe,this.detailCols=[],this.trakerCols=[],this.detailDataList=[],this.trakerDataList=[],this.formOperate=d.mi,this.rowcount=0}ngOnInit(){var t=this;return(0,b.Z)(function*(){t.form=t.fb.group({reqComment:new _.NI("")});const o=yield t.tool.getDict(["review_update_date","review_update_user","sign_off_layer","sign_off_status","sign_off_comment","api_name","api_desc","public_flag","dept","theme_name","api_doc"]);switch(t.trakerCols=[{field:"chkCreateDateTime",header:o.review_update_date},{field:"chkCreateUser",header:o.review_update_user},{field:"chkLayerName",header:o.sign_off_layer},{field:"reviewStatusName",header:o.sign_off_status},{field:"reqComment",header:o.sign_off_comment}],t.data.data.detailData.reqType){case"API_ON_OFF":t.detailCols=[{field:"apiName",header:o.api_name},{field:"apiDesc",header:o.api_desc},{field:"publicFlagName",header:o.public_flag},{field:"orgName",header:o.dept}],t.detailDataList=t.data.data.detailData.apiOnOff.apiOnOffList;break;case"API_APPLICATION":t.detailCols=[{field:"apiName",header:o.api_name},{field:"apiDesc",header:o.api_desc},{field:"publicFlagName",header:o.public_flag},{field:"orgName",header:o.dept}],t.detailDataList=t.data.data.detailData.apiUserApply.apiList;break;case"OPEN_API_KEY":t.detailCols=[{field:"apiName",header:o.api_name},{field:"apiDesc",header:o.api_desc},{field:"orgName",header:o.dept}],t.detailDataList=t.data.data.detailData.openApiKey.apiDatas;break;default:t.detailDataList=[]}t.data.operate==d.mi.traker&&(t.trakerDataList=t.data.data.trakerData.dataList,t.rowcount=t.trakerDataList.length),t.form.valueChanges.subscribe(l=>{t.change.emit(l.reqComment)})})()}checkLength(t,a){return Object.keys(t).length>1&&a+1!=Object.keys(t).length}moreData(){this.requisition.queryHistoryByPk({reqOrdermId:this.data.data.trakerData.reqOrdermId,chkLogId:this.trakerDataList[this.trakerDataList.length-1].chkLogId}).subscribe(a=>{this.tool.checkDpSuccess(a.ResHeader)&&(this.trakerDataList=this.trakerDataList.concat(a.RespBody.dataList),this.rowcount=this.trakerDataList.length)})}downloadFile(t,a){this.file.downloadFile({filePath:t}).subscribe(l=>{const p=new FileReader;p.onloadend=function(){const s=new File([l],a),r=window.URL.createObjectURL(s),c=document.createElement("a");document.body.appendChild(c),c.setAttribute("style","display: none"),c.href=r,c.download=a,c.click(),window.URL.revokeObjectURL(r),c.remove()},p.readAsText(l)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.qu),e.Y36(F.I),e.Y36(w.g),e.Y36(P.H))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-requisition-form"]],inputs:{data:"data"},outputs:{change:"change"},decls:82,vars:60,consts:[[1,"container","py-1"],[1,"card","card-body","bg-light","mt-3"],[1,"form-group","row"],[1,"col-6","col-sm-6"],[1,"control-label"],["class","col-6 col-sm-6",4,"ngIf"],[1,"col-12","col-sm-12"],["rows","2","readonly","","autoResize","autoResize",1,"form-control",2,"resize","none",3,"innerHtml"],["class","col-12 col-sm-12",4,"ngIf"],["class","form-group row",4,"ngIf"],[3,"formGroup"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["styleClass","p-datatable-striped",3,"columns","value","style",4,"ngIf"],["styleClass","p-datatable-striped",3,"columns","value"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[2,"width","10%"],[3,"width",4,"ngFor","ngForOf"],["scope","col",2,"width","10%"],["scope","col",3,"width",4,"ngFor","ngForOf"],["scope","col"],[4,"ngIf"],[4,"ngFor","ngForOf"],["href","javascript:void(0)",3,"click",4,"ngFor","ngForOf"],["styleClass","p-datatable-striped","scrollHeight","100%",3,"columns","value","scrollable","style",4,"ngIf"],["styleClass","p-datatable-striped","scrollHeight","100%",3,"columns","value","scrollable"],["pTemplate","footer"],["pTemplate","emptymessage"],[2,"color","#b7b7b7"],["type","button",1,"btn","tpi-header-return",3,"click"],[1,"fas","fa-angle-double-right",2,"margin-left","5px"],["rows","10","formControlName","reqComment",1,"form-control"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"label"),e._uU(8),e.qZA()(),e.TgZ(9,"div",3)(10,"label",4),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"label"),e._uU(14),e.qZA()(),e.TgZ(15,"div",3)(16,"label",4),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"label"),e._uU(20),e.qZA()(),e.TgZ(21,"div",3)(22,"label",4),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"label"),e._uU(26),e.qZA()(),e.TgZ(27,"div",3)(28,"label",4),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"label"),e._uU(32),e.qZA()(),e.TgZ(33,"div",3)(34,"label",4),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"label"),e._uU(38),e.qZA()(),e.TgZ(39,"div",3)(40,"label",4),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.TgZ(43,"label"),e._uU(44),e.qZA()(),e.TgZ(45,"div",3)(46,"label",4),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"label"),e._uU(50),e.qZA()(),e.YNc(51,di,6,4,"div",5),e.YNc(52,fi,6,5,"div",5),e.TgZ(53,"div",6)(54,"label",4),e._uU(55),e.ALo(56,"translate"),e.qZA(),e._UZ(57,"textarea",7),e.qZA()(),e.TgZ(58,"div",2)(59,"div",6)(60,"label",4),e._uU(61),e.ALo(62,"translate"),e.qZA()(),e.YNc(63,hi,6,4,"div",5),e.YNc(64,gi,6,4,"div",5),e.YNc(65,bi,6,4,"div",5),e.YNc(66,vi,6,4,"div",5),e.YNc(67,Ai,6,4,"div",5),e.YNc(68,Ti,6,4,"div",5),e.YNc(69,qi,6,4,"div",5),e.YNc(70,Zi,6,4,"div",5),e.YNc(71,xi,6,4,"div",5),e.YNc(72,yi,6,4,"div",8),e.YNc(73,Ni,5,1,"div",8),e.YNc(74,wi,5,1,"div",8),e.YNc(75,Oi,6,4,"div",5),e.YNc(76,Ci,6,4,"div",5),e.YNc(77,Mi,2,1,"div",8),e.qZA(),e.YNc(78,ia,7,4,"div",9),e.TgZ(79,"form",10),e.YNc(80,aa,6,3,"div",9),e.qZA()(),e._UZ(81,"br"),e.qZA()),2&t&&(e.xp6(5),e.hij("",e.lcZ(6,40,"case_number"),"\uff1a"),e.xp6(3),e.Oqu(a.data.data.detailData.reqOrderNo),e.xp6(3),e.hij("",e.lcZ(12,42,"apply_date"),"\uff1a"),e.xp6(3),e.Oqu(a.data.data.detailData.createDateTime),e.xp6(3),e.hij("",e.lcZ(18,44,"sign_off_type"),"\uff1a"),e.xp6(3),e.Oqu(a.data.data.detailData.title),e.xp6(3),e.hij("",e.lcZ(24,46,"req_sub_type"),"\uff1a"),e.xp6(3),e.Oqu(a.data.data.detailData.subTitle),e.xp6(3),e.hij("",e.lcZ(30,48,"effective_date"),"\uff1a"),e.xp6(3),e.Oqu(a.data.data.detailData.effectiveDate),e.xp6(3),e.hij("",e.lcZ(36,50,"sign_off_status"),"\uff1a"),e.xp6(3),e.AsE("",a.data.data.detailData.chkPointName," - ",a.data.data.detailData.chkStatusName,""),e.xp6(3),e.hij("",e.lcZ(42,52,"apply_org"),"\uff1a"),e.xp6(3),e.Oqu(a.data.data.detailData.orgName),e.xp6(3),e.hij("",e.lcZ(48,54,"apply_user"),"\uff1a"),e.xp6(3),e.Oqu(a.data.data.detailData.applyUserName),e.xp6(1),e.Q6J("ngIf","API_ON_OFF"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","CLIENT_REG"==a.data.data.detailData.reqType||"API_APPLICATION"==a.data.data.detailData.reqType),e.xp6(3),e.hij("",e.lcZ(56,56,"apply_desc"),"\uff1a"),e.xp6(2),e.Q6J("innerHtml",a.data.data.detailData.reqDesc,e.oJD),e.xp6(4),e.hij("",e.lcZ(62,58,"dialog.detail_query"),"\uff1a"),e.xp6(2),e.Q6J("ngIf","CLIENT_REG"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","CLIENT_REG"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","CLIENT_REG"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","CLIENT_REG"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","API_APPLICATION"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","API_APPLICATION"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","API_APPLICATION"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","OPEN_API_KEY"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","OPEN_API_KEY"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","OPEN_API_KEY"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","OPEN_API_KEY"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","OPEN_API_KEY"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","OPEN_API_KEY"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","OPEN_API_KEY"==a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf","CLIENT_REG"!=a.data.data.detailData.reqType),e.xp6(1),e.Q6J("ngIf",a.data.operate==a.formOperate.traker),e.xp6(1),e.Q6J("formGroup",a.form),e.xp6(1),e.Q6J("ngIf",a.data.operate==a.formOperate.review))},directives:[g.O5,A.iA,T.jx,g.sg,_._Y,_.JL,_.sg,_.Fj,_.JJ,_.u],pipes:[N.X$,g.Nd],styles:[""]}),i})();var oa=u(55069),la=u(78215),sa=u(63710),V=u(33725),pa=u(19114),ca=u(15315);const ra=["dialog"],_a=["requisitionViewRef"];function da(i,n){1&i&&e._UZ(0,"col"),2&i&&e.Udp("width",n.$implicit.width)}function ua(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e.YNc(1,da,1,2,"col",33),e._UZ(2,"col",34),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function ma(i,n){if(1&i&&(e.TgZ(0,"th",37),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.header," ")}}function fa(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,ma,2,1,"th",35),e.TgZ(2,"th",36),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t),e.xp6(2),e.Oqu(e.lcZ(4,2,"action"))}}function ha(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,a=e.oxw().$implicit;e.xp6(1),e.hij(" ",a[t.field]," ")}}function ga(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE(" ",t.checkPointName," - ",t.chkStatus," ")}}function ba(i,n){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,ha,2,1,"span",45),e.YNc(2,ga,2,2,"span",45),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf","chkStatus"!=t.field),e.xp6(1),e.Q6J("ngIf","chkStatus"==t.field)}}function va(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(4);return l.showDialog(o,l.formOperate.review)}),e.ALo(1,"translate"),e.qZA()}2&i&&e.Q6J("pTooltip",e.lcZ(1,1,"button.review"))}function Aa(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(4);return l.showDialog(o,l.formOperate.traker)}),e.ALo(1,"translate"),e.qZA()}2&i&&e.Q6J("pTooltip",e.lcZ(1,1,"button.tracker"))}function Ta(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(4);return l.showDialog(o,l.formOperate.settle)}),e.ALo(1,"translate"),e.qZA()}2&i&&e.Q6J("pTooltip",e.lcZ(1,1,"button.close"))}function qa(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(4);return l.showDialog(o,l.formOperate.resend)}),e.ALo(1,"translate"),e.qZA()}2&i&&e.Q6J("pTooltip",e.lcZ(1,1,"button.resend"))}function Za(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",50),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(4);return l.showDialog(o,l.formOperate.update)}),e.ALo(1,"translate"),e.qZA()}2&i&&e.Q6J("pTooltip",e.lcZ(1,1,"button.edit"))}function xa(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,l=e.oxw(4);return l.showDialog(o,l.formOperate.create)}),e.ALo(1,"translate"),e.qZA()}2&i&&e.Q6J("pTooltip",e.lcZ(1,1,"button.submit_for_review"))}function ya(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,ba,3,2,"td",38),e.TgZ(2,"td",39),e.YNc(3,va,2,3,"button",40),e.YNc(4,Aa,2,3,"button",41),e.YNc(5,Ta,2,3,"button",42),e.YNc(6,qa,2,3,"button",43),e.YNc(7,Za,2,3,"button",44),e.YNc(8,xa,2,3,"button",43),e.qZA()()),2&i){const t=n.$implicit,a=n.columns;e.xp6(1),e.Q6J("ngForOf",a),e.xp6(2),e.Q6J("ngIf","Y"==t.reviewVisiable),e.xp6(1),e.Q6J("ngIf","Y"==t.trakerVisiable),e.xp6(1),e.Q6J("ngIf","Y"==t.closeVisiable),e.xp6(1),e.Q6J("ngIf","Y"==t.resendVisiable),e.xp6(1),e.Q6J("ngIf","Y"==t.updateVisiable),e.xp6(1),e.Q6J("ngIf","Y"==t.sendVisible)}}function Na(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",51)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",52),e.NdJ("click",function(){return e.CHM(t),e.oxw(5).moreData()}),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"i",53),e.qZA()()()}if(2&i){const t=e.oxw().$implicit,a=e.oxw(4);e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(2),e.AsE("",e.lcZ(4,4,"row_count"),": ",a.rowcount,""),e.xp6(3),e.hij("",e.lcZ(7,6,"button.more")," ")}}function wa(i,n){if(1&i&&e.YNc(0,Na,9,8,"tr",45),2&i){const t=e.oxw(4);e.Q6J("ngIf",t.rowcount)}}function Oa(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"no_rec")," ")}}const Ca=function(){return{"word-break":"break-word"}};function Da(i,n){if(1&i&&(e.TgZ(0,"p-table",28),e.YNc(1,ua,3,1,"ng-template",29),e.YNc(2,fa,5,4,"ng-template",30),e.YNc(3,ya,9,7,"ng-template",31),e.YNc(4,wa,1,1,"ng-template",18),e.YNc(5,Oa,4,4,"ng-template",32),e.qZA()),2&i){const t=e.oxw(3);e.Akn(e.DdM(4,Ca)),e.Q6J("columns",t.cols)("value",t.dataList)}}function Fa(i,n){if(1&i&&(e.TgZ(0,"p-tabPanel",26),e.YNc(1,Da,6,5,"p-table",27),e.qZA()),2&i){const t=n.$implicit,a=n.index,o=e.oxw(2);e.Q6J("header",t.label)("selected",0==a),e.xp6(1),e.Q6J("ngIf",o.cols)}}function Ia(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"p-tabView",24),e.NdJ("onChange",function(o){return e.CHM(t),e.oxw().changeTab(o)}),e.YNc(1,Fa,2,3,"p-tabPanel",25),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.tabTitles)}}const Ua=function(){return{backgroundColor:"var(--red-300)","border-color":"var(--red-300)"}};function ka(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",54)(1,"button",55),e.NdJ("click",function(){return e.CHM(t),e.oxw(),e.MAs(29).accept()}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",56),e.NdJ("click",function(){return e.CHM(t),e.oxw(),e.MAs(29).reject()}),e.ALo(4,"translate"),e.qZA()()}2&i&&(e.xp6(1),e.s9C("label",e.lcZ(2,3,"button.confirm")),e.Q6J("ngStyle",e.DdM(7,Ua)),e.xp6(2),e.s9C("label",e.lcZ(4,5,"button.cancel")))}function La(i,n){}function Ra(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",57),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeReg("ACCEPT")}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"button.approve")))}function Ya(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeReg("RETURN")}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"button.return")))}function Ja(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeReg("DENIED")}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"button.reject")))}function Qa(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeReg("END")}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"button.confirm")))}function Pa(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){return e.CHM(t),e.oxw().doResend()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"button.resend")))}const G=function(){return{width:"95%"}},K=function(){return{width:"100%"}},Sa=function(){return{marginTop:"60px"}},Ea=function(){return{width:"50vw"}},Ba=[{path:"",component:(()=>{class i extends O.H{constructor(t,a,o,l,p,s,r,c,m,f,h,v){super(t,a),this.fb=o,this.requisition=l,this.tool=p,this.translate=s,this.apiSignOff=r,this.listService=c,this.message=m,this.ngxService=f,this.dialogService=h,this.confirmationService=v,this.formOperate=d.mi,this.dataList=[],this.cols=[],this.rowcount=0,this.dialogTitle="",this.display=!1,this.reviewBtnFlag=!1,this.closeBtnFlag=!1,this.resendBtnFlag=!1,this.comment="",this.reqTypes=[],this.subTypes=[],this.currentQuyType=""}ngOnInit(){var t=this;return(0,b.Z)(function*(){var a,o;t.form=t.fb.group({keyword:new _.NI(""),startDate:new _.NI(""),endDate:new _.NI(""),encodeReqType:new _.NI("all"),encodeReqSubtype:new _.NI("all")}),t.converDateInit();const p=yield t.tool.getDict(["apply_date","all","apply_type","apply_user","message.layer","status","case_number"]);t.cols=[{field:"createDateTime",header:p.apply_date},{field:"reqOrderNo",header:p.case_number},{field:"applyUserName",header:p.apply_user},{field:"applyType",header:p.apply_type},{field:"chkStatus",header:p.status}];let s={encodeItemNo:t.tool.Base64Encoder(t.tool.BcryptEncoder("ORDERM_QUY_TYPE"))+",13",isDefault:"N"};t.listService.querySubItemsByItemNo(s).subscribe(r=>{var c;if(t.tool.checkDpSuccess(r.ResHeader)){let m=[];null===(c=r.RespBody.subItems)||void 0===c||c.map(h=>{m.push({label:h.subitemName,value:h.subitemNo})}),t.tabTitles=m,t.currentQuyType=t.tabTitles[0].value,t.dataList=[],t.rowcount=t.dataList.length;let f={keyword:t.keyword.value,startDate:q(t.startDate.value).format("YYYY/MM/DD"),endDate:q(t.endDate.value).format("YYYY/MM/DD"),encodeQuyType:t.tool.Base64Encoder(t.tool.BcryptEncoder(t.currentQuyType))+","+t.convertQuyTypeIndex(t.currentQuyType)};"all"!=t.encodeReqType.value&&(f.encodeReqType=t.tool.Base64Encoder(t.tool.BcryptEncoder(t.encodeReqType.value))+","+t.convertReqTypeIndex(t.encodeReqType.value)),"all"!=t.encodeReqSubtype.value&&(f.encodeReqSubtype=t.tool.Base64Encoder(t.tool.BcryptEncoder(t.encodeReqSubtype.value))+","+t.convertReqSubtypeIndex(t.encodeReqSubtype.value)),t.requisition.queryReqLikeList_ignore1298(f).subscribe(h=>{t.tool.checkDpSuccess(h.ResHeader)&&(t.dataList=h.RespBody.dataList,t.rowcount=t.dataList.length)})}}),null===(a=t.startDate)||void 0===a||a.valueChanges.subscribe(r=>{var c,m,f;if(!r)return void(null===(c=t.startDate)||void 0===c||c.setValue(new Date,{emitEvent:!1}));const h=new Date(r);h.setHours(0,0,0,0);const v=new Date(null===(m=t.endDate)||void 0===m?void 0:m.value);v.setHours(0,0,0,0),v<h&&(null===(f=t.endDate)||void 0===f||f.setValue(h))}),null===(o=t.endDate)||void 0===o||o.valueChanges.subscribe(r=>{var c,m,f;if(!r)return void(null===(c=t.endDate)||void 0===c||c.setValue(new Date,{emitEvent:!1}));const h=new Date(r);h.setHours(0,0,0,0);const v=new Date(null===(m=t.startDate)||void 0===m?void 0:m.value);v.setHours(0,0,0,0),h<v&&(null===(f=t.startDate)||void 0===f||f.setValue(h))})})()}converDateInit(){let t=new Date;this.startDate.setValue(this.tool.addDay(t,-6)),this.endDate.setValue(t)}submitForm(){this.dataList=[],this.rowcount=this.dataList.length;let t={keyword:this.keyword.value,startDate:q(this.startDate.value).format("YYYY/MM/DD"),endDate:q(this.endDate.value).format("YYYY/MM/DD"),encodeQuyType:this.tool.Base64Encoder(this.tool.BcryptEncoder(this.currentQuyType))+","+this.convertQuyTypeIndex(this.currentQuyType)};"all"!=this.encodeReqType.value&&(t.encodeReqType=this.tool.Base64Encoder(this.tool.BcryptEncoder(this.encodeReqType.value))+","+this.convertReqTypeIndex(this.encodeReqType.value)),"all"!=this.encodeReqSubtype.value&&(t.encodeReqSubtype=this.tool.Base64Encoder(this.tool.BcryptEncoder(this.encodeReqSubtype.value))+","+this.convertReqSubtypeIndex(this.encodeReqSubtype.value)),this.ngxService.start(),this.requisition.queryReqLikeList(t).subscribe(a=>{this.tool.checkDpSuccess(a.ResHeader)&&(this.dataList=a.RespBody.dataList,this.rowcount=this.dataList.length),this.ngxService.stopAll()})}showDialog(t,a){this.translate.get(["dialog.update","dialog.traker","message.update","message.requisition.label","message.success","message.close_app","message.resend","button.review","cfm_send","message.requisition.send_ps","button.edit"]).pipe((0,te.w)(l=>this.openDialog$(t,a,l))).subscribe()}openDialog$(t,a,o){let l={reqOrdermId:t.reqOrdermId,encodeQuyType:this.tool.Base64Encoder(this.tool.BcryptEncoder(this.currentQuyType))+","+this.convertQuyTypeIndex(this.currentQuyType)};return new ie.y(p=>{switch(a){case d.mi.review:this.comment="",this.requisition.queryReqByPk(l).subscribe(s=>{this.tool.checkDpSuccess(s.ResHeader)&&(this.reviewBtnFlag=!0,this.closeBtnFlag=!1,this.resendBtnFlag=!1,this.requisitionDetail=s.RespBody,this.dialogTitle=o["button.review"],this.createRequisitionRef(a,this.requisitionDetail),p.next(!0))});break;case d.mi.traker:this.requisition.queryReqByPk(l).subscribe(s=>{this.tool.checkDpSuccess(s.ResHeader)&&(this.dialogTitle=o["dialog.traker"],this.requisition.queryHistoryByPk({reqOrdermId:t.reqOrdermId}).subscribe(c=>{this.tool.checkDpSuccess(c.ResHeader)&&(this.reviewBtnFlag=!1,this.closeBtnFlag=!1,this.resendBtnFlag=!1,this.requisitionDetail=s.RespBody,this.createRequisitionRef(a,this.requisitionDetail,c.RespBody),p.next(!0))}))});break;case d.mi.settle:this.requisition.queryReqByPk(l).subscribe(s=>{this.tool.checkDpSuccess(s.ResHeader)&&(this.reviewBtnFlag=!1,this.closeBtnFlag=!0,this.resendBtnFlag=!1,this.requisitionDetail=s.RespBody,this.dialogTitle=o["message.close_app"],this.createRequisitionRef(a,this.requisitionDetail),p.next(!0))});break;case d.mi.resend:case d.mi.update:this.dialogTitle=a==d.mi.resend?o["message.resend"]:o["button.edit"],this.requisition.queryReqByPk(l).subscribe(s=>{if(this.tool.checkDpSuccess(s.ResHeader)){let r={operate:a==d.mi.resend?d.mi.resend:d.mi.update,data:s.RespBody,afterCloseCallback:c=>{c&&(this.message.add({severity:"success",summary:`${a==d.mi.resend?o["message.resend"]:o["message.update"]} ${o["message.requisition.label"]}`,detail:`${a==d.mi.resend?o["message.resend"]:o["message.update"]} ${o["message.success"]}!`}),this.submitForm())}};switch(s.RespBody.reqType){case"API_ON_OFF":this._dialog.open(wt,r);break;case"CLIENT_REG":break;case"API_APPLICATION":this.dialogService.open(_i,{autoZIndex:!0,header:o["button.chs_api"],data:{operate:a==d.mi.resend?d.mi.resend:d.mi.update,data:s.RespBody}}).onClose.subscribe(m=>{m&&(this.message.add({severity:"success",summary:`${a==d.mi.resend?o["message.resend"]:o["message.update"]} ${o["message.requisition.label"]}`,detail:`${a==d.mi.resend?o["message.resend"]:o["message.update"]} ${o["message.success"]}!`}),this.submitForm())});break;case"OPEN_API_KEY":this._dialog.open(oa.V,r)}p.next(!0)}});break;case d.mi.create:this.requisition.queryReqByPk(l).subscribe(s=>{this.tool.checkDpSuccess(s.ResHeader)&&(this.requisitionDetail=s.RespBody,this.confirmationService.confirm({header:o.cfm_send,message:o["message.requisition.send_ps"],accept:()=>{this.onCreateRequisition()}}),p.next(!0))})}})}createRequisitionRef(t,a,o){this.requisitionViewRef.clear();let l=this.requisitionViewRef.createComponent(na);l.instance.data={operate:t,data:{detailData:a,trakerData:o},displayInDialog:!0},this.display=!0,l.instance.change.subscribe(s=>{this.comment=s})}moreData(){let t={reqOrdermId:this.dataList[this.dataList.length-1].reqOrdermId,keyword:this.keyword.value,startDate:q(this.startDate.value).format("YYYY/MM/DD"),endDate:q(this.endDate.value).format("YYYY/MM/DD"),encodeQuyType:this.tool.Base64Encoder(this.tool.BcryptEncoder(this.currentQuyType))+","+this.convertQuyTypeIndex(this.currentQuyType)};"all"!=this.encodeReqType.value&&(t.encodeReqType=this.tool.Base64Encoder(this.tool.BcryptEncoder(this.encodeReqType.value))+","+this.convertReqTypeIndex(this.encodeReqType.value)),"all"!=this.encodeReqSubtype.value&&(t.encodeReqSubtype=this.tool.Base64Encoder(this.tool.BcryptEncoder(this.encodeReqSubtype.value))+","+this.convertReqSubtypeIndex(this.encodeReqSubtype.value)),this.requisition.queryReqLikeList(t).subscribe(a=>{this.tool.checkDpSuccess(a.ResHeader)&&(this.dataList=this.dataList.concat(a.RespBody.dataList),this.rowcount=this.dataList.length)})}convertReqTypeIndex(t){switch(t){case"API_APPLICATION":return 0;case"API_ON_OFF":return 1;case"CLIENT_REG":return 2;case"OPEN_API_KEY":return 3;default:return-1}}convertReqSubtypeIndex(t){switch(t){case"API_ON":case"OPEN_API_KEY_APPLICA":return 0;case"API_OFF":case"OPEN_API_KEY_UPDATE":return 1;case"API_ON_UPDATE":case"OPEN_API_KEY_REVOKE":return 2;default:return-1}}convertQuyTypeIndex(t){switch(t){case"REQ":return 0;case"EXA":return 1;case"REV":return 2;default:return-1}}changeTab(t){this.dataList=[],this.rowcount=this.dataList.length,this.currentQuyType=this.tabTitles[t.index].value,this.submitForm()}executeReg(t){var a=this;return(0,b.Z)(function*(){var o,l;const s=yield a.tool.getDict(["message.requisition.label","message.accept","message.return","message.denied","message.settle","message.success"]);let r={reqOrdermId:null===(o=a.requisitionDetail)||void 0===o?void 0:o.reqOrdermId,chkStatus:null===(l=a.requisitionDetail)||void 0===l?void 0:l.chkStatus};switch(t){case"ACCEPT":r.reqComment=a.comment,r.encodeSubItemNo=a.tool.Base64Encoder(a.tool.BcryptEncoder(t))+",1",a.apiSignOff.signReq(r).subscribe(c=>{a.tool.checkDpSuccess(c.ResHeader)&&(a.display=!1,a.message.add({severity:"success",summary:`${s["message.requisition.label"]} ${s["message.accept"]}`,detail:`${s["message.success"]}!`}),a.submitForm())});break;case"RETURN":r.reqComment=a.comment,r.encodeSubItemNo=a.tool.Base64Encoder(a.tool.BcryptEncoder(t))+",3",a.apiSignOff.signReq(r).subscribe(c=>{a.tool.checkDpSuccess(c.ResHeader)&&(a.display=!1,a.message.add({severity:"success",summary:`${s["message.requisition.label"]} ${s["message.return"]}`,detail:`${s["message.success"]}!`}),a.submitForm())});break;case"DENIED":r.reqComment=a.comment,r.encodeSubItemNo=a.tool.Base64Encoder(a.tool.BcryptEncoder(t))+",2",a.apiSignOff.signReq(r).subscribe(c=>{a.tool.checkDpSuccess(c.ResHeader)&&(a.display=!1,a.message.add({severity:"success",summary:`${s["message.requisition.label"]} ${s["message.denied"]}`,detail:`${s["message.settle"]}!`}),a.submitForm())});break;case"END":r.encodeSubItemNo=a.tool.Base64Encoder(a.tool.BcryptEncoder(t))+",5",a.apiSignOff.signReq(r).subscribe(c=>{a.tool.checkDpSuccess(c.ResHeader)&&(a.display=!1,a.message.add({severity:"success",summary:`${s["message.requisition.label"]} ${s["message.settle"]}`,detail:`${s["message.success"]}!`}),a.submitForm())})}})()}doResend(){var a,o,l,p,t=this;let s={reqOrdermId:null===(a=this.requisitionDetail)||void 0===a?void 0:a.reqOrdermId,lv:null===(o=this.requisitionDetail)||void 0===o?void 0:o.lv,act:"R",reqDesc:null===(l=this.requisitionDetail)||void 0===l?void 0:l.reqDesc,effectiveDate:null===(p=this.requisitionDetail)||void 0===p?void 0:p.effectiveDate,apiOnOffD:this.convertApiUidDatas(this.requisitionDetail.apiOnOff.apiOnOffList)};this.requisition.resendReq(s).subscribe(function(){var r=(0,b.Z)(function*(c){if(t.tool.checkDpSuccess(c.ResHeader)){const m=["message.requisition.label","message.resend","message.success"],f=yield t.tool.getDict(m);t.display=!1,t.message.add({severity:"success",summary:`${f["message.requisition.label"]} ${f["message.resend"]}`,detail:`${f["message.success"]}!`}),t.submitForm()}});return function(c){return r.apply(this,arguments)}}())}onCreateRequisition(){var t=this;this.message.clear(),this.requisition.resendReq({reqOrdermId:this.requisitionDetail.reqOrdermId,lv:this.requisitionDetail.lv,act:"S"}).subscribe(function(){var o=(0,b.Z)(function*(l){if(t.tool.checkDpSuccess(l.ResHeader)){const p=["message.requisition.label","message.send","message.success"],s=yield t.tool.getDict(p);t.display=!1,t.message.add({severity:"success",summary:`${s["message.send"]} ${s["message.requisition.label"]}`,detail:`${s["message.send"]} ${s["message.success"]}!`}),t.submitForm()}});return function(l){return o.apply(this,arguments)}}())}onReject(){this.message.clear()}convertApiUidDatas(t){let a={},o=new Object,l=new Object,p=new Object;for(let s of t){let r=new Array;for(let c in s.themeList)r.push({apiUid:s.apiUid,refThemeId:parseInt(c)});Object.keys(s.docFileInfo).length>0&&(l[s.apiUid]=Object.keys(s.docFileInfo)[0]),o[s.apiUid]=r}return p=l,a.apiUidDatas=o,a.oriApiMapFileName=l,a.newApiMapFileName=p,a.encPublicFlag=this.tool.Base64Encoder(this.tool.BcryptEncoder(this.requisitionDetail.apiOnOff.publicFlag))+","+this.requisitionDetail.apiOnOff.publicFlag,a}get keyword(){return this.form.get("keyword")}get startDate(){return this.form.get("startDate")}get endDate(){return this.form.get("endDate")}get encodeReqType(){return this.form.get("encodeReqType")}get encodeReqSubtype(){return this.form.get("encodeReqSubtype")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(x.gz),e.Y36(j.W),e.Y36(_.qu),e.Y36(P.H),e.Y36(w.g),e.Y36(N.sK),e.Y36(la.h),e.Y36(B.X),e.Y36(T.ez),e.Y36(S.LA),e.Y36(y.xA),e.Y36(T.YP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-np0401"]],viewQuery:function(t,a){if(1&t&&(e.Gf(ra,5),e.Gf(_a,5,e.s_b)),2&t){let o;e.iGM(o=e.CRH())&&(a._dialog=o.first),e.iGM(o=e.CRH())&&(a.requisitionViewRef=o.first)}},features:[e._Bn([T.YP]),e.qOj],decls:40,vars:45,consts:[[3,"title"],[3,"formGroup","ngSubmit"],[1,"form-group","row"],[1,"col-4","col-xl-4","col-lg-4"],[1,"control-label"],["type","text","formControlName","keyword",1,"form-control",3,"placeholder"],[1,"required","control-label"],[1,"d-flex","align-items-center"],["appendTo","body","formControlName","startDate","dateFormat","yy/mm/dd",3,"inputStyle","showIcon"],[1,"me-2"],["formControlName","endDate","appendTo","body","dateFormat","yy/mm/dd",3,"inputStyle","showIcon"],[1,"col-3","col-xl-3"],["type","submit",1,"btn","tpi-btn","tpi-primary","pull-right","me-2"],[3,"onChange",4,"ngIf"],["dialog",""],["position","top-left"],["icon","pi pi-exclamation-triangle","styleClass","cHeader cContent cIcon"],["cd",""],["pTemplate","footer"],[3,"header","visible","modal","dismissableMask","maximizable","draggable","visibleChange"],["requisitionViewRef",""],[1,"text-center"],["type","button","class","btn tpi-btn tpi-primary",3,"click",4,"ngIf"],["type","button","class","btn tpi-btn tpi-primary ms-2",3,"click",4,"ngIf"],[3,"onChange"],[3,"header","selected",4,"ngFor","ngForOf"],[3,"header","selected"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value","style",4,"ngIf"],["selectionMode","single","styleClass","p-datatable-striped",3,"columns","value"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"width",4,"ngFor","ngForOf"],[2,"width","15%"],["scope","col","pResizableColumn","",4,"ngFor","ngForOf"],["scope","col",2,"width","15%"],["scope","col","pResizableColumn",""],[4,"ngFor","ngForOf"],[2,"text-align","center","width","15%"],["pButton","","pRipple","","type","button","icon","fa fa-check","class","p-button-rounded p-button-text p-button-plain","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","fa fa-tasks","class","p-button-rounded p-button-text p-button-plain","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","fa fa-trash-alt","class","p-button-rounded p-button-text p-button-plain","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","fa fa-paper-plane","class","p-button-rounded p-button-text p-button-plain","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","fa fa-edit","class","p-button-rounded p-button-text p-button-plain","tooltipPosition","top",3,"pTooltip","click",4,"ngIf"],[4,"ngIf"],["pButton","","pRipple","","type","button","icon","fa fa-check","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-plain",3,"pTooltip","click"],["pButton","","pRipple","","type","button","icon","fa fa-tasks","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-plain",3,"pTooltip","click"],["pButton","","pRipple","","type","button","icon","fa fa-trash-alt","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-plain",3,"pTooltip","click"],["pButton","","pRipple","","type","button","icon","fa fa-paper-plane","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-plain",3,"pTooltip","click"],["pButton","","pRipple","","type","button","icon","fa fa-edit","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-plain",3,"pTooltip","click"],[2,"color","#b7b7b7"],["type","button",1,"btn","tpi-header-return",3,"click"],[1,"fas","fa-angle-double-right",2,"margin-left","5px"],[1,"row",2,"justify-content","center"],["type","button","pButton","","icon","pi pi-check",3,"ngStyle","label","click"],["type","button","pButton","","icon","pi pi-times",1,"p-button-secondary",3,"label","click"],["type","button",1,"btn","tpi-btn","tpi-primary",3,"click"],["type","button",1,"btn","tpi-btn","tpi-primary","ms-2",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"app-container",0)(1,"form",1),e.NdJ("ngSubmit",function(){return a.submitForm()}),e.TgZ(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"input",5),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",3)(10,"label",6),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"p-calendar",8),e.TgZ(15,"label",9),e._uU(16,"\uff5e"),e.qZA(),e._UZ(17,"p-calendar",10),e.qZA()()(),e.TgZ(18,"div",2)(19,"div",11)(20,"button",12),e._uU(21),e.ALo(22,"translate"),e.qZA()()()(),e._UZ(23,"hr"),e.YNc(24,Ia,2,1,"p-tabView",13),e.qZA(),e._UZ(25,"app-dialog",0,14)(27,"p-toast",15),e.TgZ(28,"p-confirmDialog",16,17),e.YNc(30,ka,5,8,"ng-template",18),e.qZA(),e.TgZ(31,"p-dialog",19),e.NdJ("visibleChange",function(l){return a.display=l}),e.YNc(32,La,0,0,"ng-template",null,20,e.W1O),e.TgZ(34,"div",21),e.YNc(35,Ra,3,3,"button",22),e.YNc(36,Ya,3,3,"button",23),e.YNc(37,Ja,3,3,"button",23),e.YNc(38,Qa,3,3,"button",23),e.YNc(39,Pa,3,3,"button",23),e.qZA()()),2&t&&(e.Q6J("title",a.title),e.xp6(1),e.Q6J("formGroup",a.form),e.xp6(4),e.Oqu(e.lcZ(6,31,"keyword_search")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,33,"plz_enter")),e.xp6(4),e.Oqu(e.lcZ(12,35,"apply_date")),e.xp6(3),e.Akn(e.DdM(39,G)),e.Q6J("inputStyle",e.DdM(40,K))("showIcon",!0),e.xp6(3),e.Akn(e.DdM(41,G)),e.Q6J("inputStyle",e.DdM(42,K))("showIcon",!0),e.xp6(4),e.Oqu(e.lcZ(22,37,"button.search")),e.xp6(3),e.Q6J("ngIf",a.tabTitles),e.xp6(1),e.Q6J("title",a.dialogTitle),e.xp6(2),e.Akn(e.DdM(43,Sa)),e.xp6(1),e.Akn(e.DdM(44,Ea)),e.xp6(3),e.s9C("header",a.dialogTitle),e.Q6J("visible",a.display)("modal",!0)("dismissableMask",!0)("maximizable",!1)("draggable",!1),e.xp6(4),e.Q6J("ngIf",a.reviewBtnFlag),e.xp6(1),e.Q6J("ngIf",a.reviewBtnFlag),e.xp6(1),e.Q6J("ngIf",a.reviewBtnFlag),e.xp6(1),e.Q6J("ngIf",a.closeBtnFlag),e.xp6(1),e.Q6J("ngIf",a.resendBtnFlag))},directives:[sa.e,_._Y,_.JL,_.sg,_.Fj,_.JJ,_.u,E.f,g.O5,V.xf,g.sg,V.x4,A.iA,T.jx,A.Q7,C.Hq,H.u,J.a,Q.FN,pa.Q,g.PC,ca.V],pipes:[N.X$],styles:[""]}),i})(),canActivate:[R.u6]}];let $a=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[x.Bz.forChild(Ba)],x.Bz]}),i})(),Ma=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[R.u6],imports:[[g.ez,$a,k.W,L.m,_.UX,_.u5]]}),i})()},46877:(ee,U,u)=>{u.d(U,{X:()=>R});var g=u(92340),k=u(57553),L=u(87587),_=u(96614);let R=(()=>{class x{constructor(e){this.api=e,this.api.baseUrl=g.N.dpPath}get basePath(){return g.N.isv4?"dgrv4/11":"tsmpdpaa/11"}querySubItemsByItemNo(e){let O={ReqHeader:this.api.getReqHeader(k.Nx.querySubItemsByItemNo),ReqBody:e};return this.api.npPost(`${this.basePath}/DPB0047`,O)}queryNewsStatusList(e){let O={ReqHeader:this.api.getReqHeader(k.Nx.querySubItemsByItemNo),ReqBody:e};return this.api.npPost(`${this.basePath}/DPB0048`,O)}}return x.\u0275fac=function(e){return new(e||x)(L.LFG(_.K))},x.\u0275prov=L.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})()}}]);